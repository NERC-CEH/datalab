# System testing

## 1. Introduction

### 1.1 Purpose of this document

This document is the System Test Script for project 10893.

### 1.2 Scope of this document

This document the test cases to test new functionality and, where available, existing dependent regression testing for the existing system. It also provides non-functional test cases where appropriate.

### 1.3 Context of this issue

This System Test Script has been produced during the project and any subsequent changes will be documented as the project progresses.

## 2 System Test Script (Functional Testing)

System testing is carried out as part of every sprint to ensure the completed stories and updated system meets all the applicable requirements. For full details on the system testing process, please consult the project test plan.

### 2.1 Template for Test Cases

#### TC[x.y.z] TESTCASE TITLE HERE

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 |  |  |  |
| 2 |  |  |  |
| 3 |  |  |  |
| 4 |  |  |  |
| 5 |  |  |  |
---

### 2.1 Homepage

#### 2.1.1 Create Project

#### 2.1.2 Delete Project

##### TC2.1.2.1 User can delete existing projects

| **JIRA ID(s):** | [NERCDL-727](https://jira.ceh.ac.uk/browse/NERCDL-727?jql=key%20in%20(NERCDL-727)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to <https://testlab.test-datalabs.nerc.ac.uk/projects>| Existing projects that the user has access to are shown here |  |
| 2 | Click on open | User is taken to the project overview page |  |
| 3 | Copy the URL and then press the back button in the browser | URL is copied and the user is taken back to the projects page |
| 5 | Click on the three dotted button next to a project | There is only the option to delete the project |  |
| 6 | Press the delete button | User is shown a dialog asking them to confirm the deletion. There is a text field for the user to enter a specific string to confirm the deletion |  |
| 7 | Press delete without entering the confirmation string | Nothing happens as the button is greyed out |  |
| 8 | Press delete after entering an incorrect confirmation string | Nothing happens as the button is greyed out |  |
| 9 | Press delete after entering the correct confirmation string | Project is deleted. There is a confirmation message displayed in the UI. |  |
| 10 | Paste the URL into the browser and try to navigate back to the deleted project | User is re-directed back to <https://testlab.test-datalabs.nerc.ac.uk/projects>|  |
---

#### TC2.1.2.2 Project deletions prevent assets being listed

| **JIRA ID(s):** | [NERCDL-1039](https://jira.ceh.ac.uk/browse/NERCDL-1039?jql=key%20in%20(NERCDL-1039)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the projects page and create a new project | Project is created | PASS |
| 2 | Navigate to the Asset Repo page and create a new asset this is only visible to the project created in step 1 | Asset is created | PASS |
| 3 | Navigate to Find Asset | Asset created above can be found on this page | PASS |
| 4 | Delete the project created in step 1 | Project is deleted successfully | PASS |
| 5 | Navigate to Find Asset | The asset is still present and visibility is still set to 'by project'. There are no projects selected. Pre-existing assets have not been altered/effected by these tests | PASS |
---

#### 2.1.3 List Projects

##### 2.1.3.1 List All Projects

##### 2.1.3.2 List My Projects

##### 2.1.3.3 Pagination of Project List

###### TC2.1.3.3.1 Maximum number of projects shown on a single page is 10

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them  | 30 projects are available and displayed  |  |
| 2 | Check the displayed page number equals 1  | Page number = 1  |  |
| 3 | Check the number of displayed projects on page 1 | First set of 10 projects are displayed  |  |
| 4 | Select the Next Page icon | User is taken to page 2  |  |
| 5 | Check the number of displayed projects on page 2  | Next set of 10 projects are displayed  |  |
| 6 | Select the Next Page icon  | User is taken to page 3  |  |
| 7 | Check the number of displayed projects on page 3  | Last set of 10 projects are displayed |  |
---

###### TC2.1.3.3.2 Pagination component displays the correct number of pages

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 | Check the Pagination control | Pagination control displays Page 1 of 3, '1' is an editable value |  |
| 3 | Select the Next Page icon | User is taken to page 2 |  |
| 4 | Check the Pagination control | Pagination control displays Page 2 of 3, '1' is an editable value  |  |
| 5 |Select the Next Page icon | User is taken to page 3 |  |
| 6 | Check the Pagination control | Pagination control displays Page 3 of 3, '1' is an editable value |  |
---

###### TC2.1.3.3.3 The next page button increments the page number by 1 if additional pages are available

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 | Ensure user is on page 1  | User is on page 1 |  |
| 3 | Check the Next Page icon and mouse-hover over it  | Icon is enabled, message informing the user they can go to the next page is displayed |  |
| 4 | Select the Next Page icon  | User is taken to page 2 |  |
| 5 | Check the Next Page icon and mouse-hover over it | Icon is enabled, message informing the user they can go to the next page is displayed |  |
| 6 | Select the Next Page icon | User is taken to page 3 |  |
---

###### TC2.1.3.3.4 The next page button does not increment the page number if there are no further pages

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 | Enter page 3 on the pagination control and select ENTER | Page 3 is loaded with correct projects |  |
| 3 | Check the Next Page icon and mouse-hover over it | Icon is disabled, message informing the user there is no next page is displayed |  |
| 4 | Select the Next Page icon | Icon is disabled, user remains on page 3 |  |
---

###### TC2.1.3.3.5 The previous page button decrements the page number by 1 if the current page number is greater than 1

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 | Enter page 3 on the pagination control and select ENTER | Page 3 is loaded with correct projects |  |
| 3 | Check the Previous Page icon and mouse-hover over it  | Icon is enabled, message informing the user they can go to the previous page is displayed |  |
| 4 | Select the Previous Page icon  | User is taken to page 2 |  |
| 5 | Check the Previous Page icon and mouse-hover over it | Icon is enabled, message informing the user they can go to the previous page is displayed |  |
| 6 | Select the Previous Page icon | User is taken to page 1 |  |
---

###### TC2.1.3.3.6 The previous page button does not decrement the page number if the the user is on page 1

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 | Enter page 1 on the pagination control and select ENTER | Page 1 is loaded with correct projects |  |
| 3 | Check the Previous Page icon and mouse-hover over it | Icon is disabled, message informing the user there is no previous page is displayed |  |
| 4 | Select the Next Page icon | Icon is disabled, user remains on page 1 |  |
---

###### TC2.1.3.3.7 The user is taken to the correct page when typing the desired page number into pagination component

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 | Check the displayed page number equals 1  | Page number = 1 |  |
| 3 | Enter page 3 on the pagination control and select ENTER | Page 3 is loaded with correct projects |  |
| 4 | Enter page 2 on the pagination control and select ENTER | Page 2 is loaded with correct projects |  |
| 5 | Enter page 1 on the pagination control and select ENTER | Page 1 is loaded with correct projects |  |
| 6 | Enter page 02 on the pagination control and select ENTER | Page 2 is loaded with correct projects |  |
---

###### TC2.1.3.3.8 Typing an invalid page value resets the value to the current page

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure 30 projects have been created and the logged in user has access to them | 30 projects are available and displayed |  |
| 2 |Check the displayed page number equals 1  | Page number = 1 |  |
| 3 | Enter page 4 on the pagination control and select ENTER | Pagination control resets to Page 1 and correct projects are displayed |  |
| 4 | Enter page 2 on the pagination control and select ENTER | Page 2 is loaded with correct projects |  |
| 5 | Enter page 4 on the pagination control and select ENTER | Pagination control resets to Page 2 and correct projects are displayed |  |
| 6 | Enter page 3 on the pagination control and select ENTER | Page 3 is loaded with correct projects |  |
| 7 | Enter page 4 on the pagination control and select ENTER | Pagination control resets to Page 3 and correct projects are displayed |  |
| 8 | Enter page 0 on the pagination control and select ENTER | Pagination control resets to Page 3 and correct projects are displayed |  |
| 9 | Enter page -1 on the pagination control and select ENTER | Pagination control resets to Page 3 and correct projects are displayed |  |
| 10 | Enter page 100 on the pagination control and select ENTER | Pagination control resets to Page 3 and correct projects are displayed |  |
| 11 | Enter page abc on the pagination control and select ENTER | Pagination control resets to Page 3 and correct projects are displayed |  |
| 12 | Enter page 1a on the pagination control and select ENTER | Pagination control resets to Page 3 and correct projects are displayed |  |
---

###### TC2.1.3.3.9 Selecting 'My projects' when on the last page of all projects, sends user to correct last page if there are fewer pages for their projects

| **JIRA ID(s):** | [NERCDL-599](https://jira.ceh.ac.uk/browse/NERCDL-599?jql=key%20in%20(NERCDL-599)), [NERCDL-626](https://jira.ceh.ac.uk/browse/NERCDL-626?jql=key%20in%20(NERCDL-626)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 |Ensure 30 projects have been created by the logged in user and the user has access to to a further 1 project not created by them | 30 current user projects and 1 other user project are available |  |
| 2 | Ensure that My Projects is deselected | Option is deselected, all projects the user can view are displayed in pages of 10 each or less |  |
| 3 | Select the last page | Last page (should be Page 4) is selected. correct projects are displayed |  |
| 4 | Select My Projects option | Option is selected, only the current user's projects are displayed, last page is displayed (should be page 3) |  |
---

##### 2.1.4 Open Project

##### 2.1.5 Request Project 

###### TC2.1.5.1 A non-admin user can request a project from the Projects page

| JIRA ID(s): | NERCDL - 825 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with a non - admin account.  | Datalabs will open. | PASS
2 | Click on the "Projects" tab.  | The projects page will open displayig all available projects the user has access to and a "Request Project" button.  | PASS
3 | Click "Request Project". | The "Request New Project" form will open. The following fields will be available: Name, Project Key, Description, Collaboration Link. | PASS
4 | Fill out the "Request New Project" form and click "Request". | A confirmation message will appear indicating a project has been requested.  | PASS
5 | Review the request in the Ethereral server.  | The message in the Ethereal server will match the data entered in step 4. | PASS
---

###### TC2.1.5.2 A project cannot be requesdted that does not have a unique project key

| JIRA ID(s): | NERCDL - 825 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with a non - admin account.  | Datalabs will open. | PASS
2 | Click on the "Projects" tab.  | The projects page will open displayig all available projects the user has access to and a "Request Project" button.  | PASS
3 | Click "Request Project". | The "Request New Project" form will open. The following fields will be available: Name, Project Key, Description, Collaboration Link. | PASS
4 | Enter data in the following fields: Name, Description and Collaboration Link. | The entered data will be filled in the fields.  | PASS
5 | Enter a Project Key that already exists. (Can be found on the Project page by clicking the "My Projects" toggle button)  | An error message will appear below the Project Key field indicating the project key already exists and it must be unique.  | PASS
6 | Click "Request Project". | The form will not close and the project request will not be submitted.  | PASS
---

### 2.2 Project View

#### 2.2.1 Select Project

#### 2.2.2 Information

#### 2.2.3 Analysis

##### 2.2.3.1 Notebooks

###### **T2.2.3.1 User can edit existing Notebooks**

| **JIRA ID(s):** | [NERCDL-613](https://jira.ceh.ac.uk/browse/NERCDL-613?jql=key%20in%20(NERCDL-613)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Open an existing project | User is taken to the project info page |  |
| 2 | Ensure there is an existing notebook that has been created | There is an existing notebook present |  |
| 3 | Click on the edit button | A dialog is opened containing the display name and description. There are three buttons: Apply, Clear Changes and Cancel. All buttons except "Cancel" are disabled.  |  |
| 4 | Remove existing text from the text fields  | Text fields are outlined in red informing the user that they cannot be blank. All buttons are enabled. |  |
| 5 | Press "Apply" | Nothing happens |  |
| 6 | Press "Clear Changes" | The original text is now present in the text fields |  |
| 7 | Replace any text with a string that contains text, numbers and special characters | Text is replaced |  |
| 8 | Press "Apply" | Changes are applied and there is a confirmation message displayed in the UI |  |
| 9 | Click on the edit button | The edit dialog is re-opened |  |
| 10 | Edit existing text | Text is edited  |  |
| 11 | Press the cancel button | Dialog is closed and  edits are not saved  |  |

###### TC2.2.3.2 User can create a JupyterLabs notebook

| **JIRA ID(s):** | [NERCDL-635](https://jira.ceh.ac.uk/browse/NERCDL-635?jql=key%20in%20) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that a Gluster storage and NFS storage have been created in the project | Storages have been created |  |
| 2 | Navigate to the Notebooks section | Existing notebooks are shown here |  |
| 3 | Click on "Create New Notebook" | A dialog is shown with the following fields: Display name, notebook type, data store to mount, description and sharing status  |  |
| 4 | Fill in the fields as required and set the data store mount to the pre-existing NFS store. Set the notebook type to Jupyterlab  | NFS store and notebook type is set |  |
| 5 | Click on "Create" | Notebook is created. There is a message in the UI stating that the creation was successful.  |  |
| 6 | Wait for a minute | THe status is changed from "Requested" to "Ready" |  |
| 7 | Repeat the above tests for pre-existing Gluster store | The same results as the NFS store (above) are seen |  |

---

###### TC2.2.3.3 User can restart stacks in the UI

| **JIRA ID(s):** | [NERCDL-648](https://jira.ceh.ac.uk/browse/NERCDL-648?jql=key%20in%20) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | View the notebooks section of Datalabs | Existing notebooks are present |  |
| 2 | Click on the three dot icon next to the notebook | User has the options to edit, share, restart or delete |  |
| 3 | Click on restart | A dialog is shown asking the user to confirm or cancel the restart |  |
| 4 | Press cancel | The dialog is closed |  |
| 5 | Click on restart | The dialog is shown again |  |
| 6 | Confirm the restart | The page is reloaded and there is a message displayed that informs the user that the restart was successful |  |
| 7 | Click on the drop down and select the edit option | A dialog window opens with the existing details |  |
| 8 | Edit the details of the notebook and press save | The notebook is edited |  |
| 9 | Repeat all of the above tests as a non-admin user | Same results are observed as an admin user |  |
---

###### TC2.2.3.4 User cannot create notebook without required fields

| **JIRA ID(s):** | [NERCDL-677](https://jira.ceh.ac.uk/browse/NERCDL-677?jql=key%20in%20(NERCDL-677)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the notebook page | Pre-existing notebooks are listed here |  |
| 2 | Click on the create button | A dialog is shown with the following fields: Display Name, Notebook Type, URL, Data Store, Source Path, Description and Sharing Status |  |
| 3 | Press the create button without entering information | Every field is outlined in red |  |
| 4 | Enter information into all fields except the sharing status. Press the create button | Site is not created. Sharing status is outlined in red with an error message informing the user that it is required |  |
| 5 | Set a sharing status and press create | The notebook is successfully created |  |
---

###### TC2.2.3.5 Extra fields when creating R Studio notebook

| **JIRA ID(s):** | [NERCDL-683](https://jira.ceh.ac.uk/browse/NERCDL-683?jql=key%20in%20(NERCDL-683)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the notebooks page | Pre-existing notebooks are listed here |  |
| 2 | Click on the create button | A dialog is shown with the following fields: Display Name, Notebook Type, URL, Data Store, Source Path, Description and Sharing Status |  |
| 3 | Fill out the required fields. Set the type to R studio | And extra field appears when R Studio is selected. This is a version field. 4.0.1 is the default value |  |
| 4 | Click on the version field | A dropdown with two options is displayed: 4.0.1 & 3.5.3 |  |
| 5 | Set the version to default and press create | Notebook is successfully created |  |
| 6 | Create another R Studio site but set the version to 3.5.3 | Notebook is successfully created |  |
---

###### TC2.2.3.6 User can select assets for notebook during creation

| **JIRA ID(s):** | [NERCDL-919](https://jira.ceh.ac.uk/browse/NERCDL-919), [NERCDL-934](https://jira.ceh.ac.uk/browse/NERCDL-934), [NERCDL-921](https://jira.ceh.ac.uk/browse/NERCDL-921) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure there are available assets for testing through the asset list page. Can be added through add asset page if required. | There is at least one of: a public asset with fileLocation, an asset available only to the project that is being used for testing with a fileLocation, an asset that is not available to the project used for testing with a fileLocation, and a project that does not have a fileLocation. |  |
| 2 | Navigate to Notebooks page of pre-existing project (create project if necessary). | Pre-existing notebooks are listed here. |  |
| 3 | Ensure logged in to account with permission to create notebooks. | Create Notebook button is displayed at the bottom of the list of notebooks |  |
| 4 | Click on the Create Notebook button | A dialog is shown with a form to fill in. One of the fields is called assets. |  |
| 5 | Click on assets multiselect field | List of assets available to project is shown. This should only include public assets with a fileLocation and assets specifically available to project used for testing with fileLocation. |  |
| 6 | Leaving all fields blank, click on create button. | Required fields show errors that they cannot be blank. The assets field shows no error (as can be left blank). |  |
| 7 | Fill in required fields leaving assets blank. Click on create button. | Notebook is created. |  |
| 8 | Click create notebook button. Fill in form with with details for new notebook including assets (which should actually exist on the repo file store). Click create button. | Notebook is created. |  |
| 9 | Wait for the notebook with assets to become ready, and open it. | Notebook is opened. |  |
| 10 | Open a Terminal | Terminal is opened. |  |
| 11 | Enter `cd /assets/` and then `cd` into your selected real asset.  Perform an `ls`. | The asset contents are listed. |  |
| 12 | Check you can read the data, e.g. `head readme.html`. | The asset data can be read. |  |
| 13 | Attempt to write to the folder, e.g. `touch test.txt`. | You should receive an error message `Read-only file system`. |  |
---

###### TC2.2.3.7 User can update assets for notebook through notebook edit menu

| **JIRA ID(s):** | [NERCDL-919](https://jira.ceh.ac.uk/browse/NERCDL-919), [NERCDL-934](https://jira.ceh.ac.uk/browse/NERCDL-934), [NERCDL-921](https://jira.ceh.ac.uk/browse/NERCDL-921)  |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure there are available assets for testing through the asset list page. Can be added through add asset page if required. | There is at least one of: a public asset with fileLocation, an asset available only to the project that is being used for testing with a fileLocation, an asset that is not available to the project used for testing with a fileLocation, and a project that does not have a fileLocation. |  |
| 2 | Navigate to Notebooks page of pre-existing project (create project if necessary). | Pre-existing notebooks are listed here. |  |
| 3 | Ensure logged in to account with permission to create notebooks. | Create Notebook button is displayed at the bottom of the list of notebooks |  |
| 4 | Ensure there is a notebook that is available to edit (create notebook if necessary). | There is at least one notebook in the list of notebooks that can be edited for testing. |  |
| 5 | Click on the notebook's three dot button and then on the edit option. | A dialog is shown with fields that can be edited. One of them is assets. The assets field is pre-populated with any assets the notebooks is using. |  |
| 6 | Click on assets multiselect field | List of assets available to project is shown. This should only include public assets with a fileLocation and assets specifically available to project used for testing with fileLocation. |  |
| 7 | Using the asset multiselect it should be possible to add and remove assets from the notebook. | The list of assets associated with the notebook has changed to be those selected. |  |
| 8 | Select assets which actually exist on the repo store and click apply. | The notebook should update successfully. |  |
| 9 | Open the notebook. | Notebook is opened. |  |
| 10 | Open a Terminal | Terminal is opened. |  |
| 11 | Enter `cd /assets/` and then `cd` into your selected real asset.  Perform an `ls`. | The asset contents are listed. |  |
| 12 | Check you can read the data, e.g. `head readme.html`. | The asset data can be read. |  |
| 13 | Attempt to write to the folder, e.g. `touch test.txt`. | You should receive an error message `Read-only file system`. |  |
---

###### TC2.2.3.8 Notebook types and available versions are controlled by values in config map

| **JIRA ID(s):** | [NERCDL-841](https://jira.ceh.ac.uk/browse/NERCDL-841) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the notebooks page of a project in which the logged in account has permission to create a notebook. | See list of any currently running notebooks in the project with a Create Notebook button below it. |  |
| 2 | Click the Create Notebook button. | Shown the create notebook dialog with fields for Type and - if the selected type allows different versions - Version. |  |
| 3 | Note the types and versions that are available. | N/A |  |
| 4 | Take a copy of the original image config map then update it to change the available types and the available versions of a notebook that allows different versions and restart the web-app pod (this may require a developer). Reload the page and click the Create Notebook button. | Shown the create notebook dialog where the values match those just set in the image config map. |  |
| 5 | Reset the value of the config map to the original value and then restart the web-app pod (this may require a developer). | System is back to the same state as before the test was run. |  |
---

#### TC2.2.3.9 User can create two jupyter noteboks without error

| **JIRA ID(s):** | [NERCDL-1017](https://jira.ceh.ac.uk/browse/NERCDL-1017?jql=key%20in%20(NERCDL-1017)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the notebooks page of a project | Pre-existing notebooks are displayed | PASS |
| 2 | Create a jupyter notebook | The notebook is created and displayed in the UI | PASS |
| 3 | Create another jupyer notebook | he notebook is created and displayed in the UI | PASS |
---

#### TC2.2.3.10 Notebooks can be deleted without a page refresh

| **JIRA ID(s):** | [NERCDL-1017](https://jira.ceh.ac.uk/browse/NERCDL-1017?jql=key%20in%20(NERCDL-1017)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the notebooks page of a project | Notebooks page loads and pre-existing sites are present | PASS |
| 2 | Click on the create notebook button | A dialog is shown with the following fields: Display name, notebook type, data store to mount, description and sharing status | PASS |
| 3 | Fill in the required fields and create the notebook | Notebook is created and it is displayed in the UI with a requested status | PASS |
| 4 | Wait for a few minutes | The requested status changes to a ready status | PASS |
| 5 | Click on the three dots next to the created notebook | There is an option to delete the notebook | PASS |
| 6 | Click on delete | A confirmation dialog is shown asking the user to cancel or confirm | PASS |
| 7 | Click on cancel | The deletion is cancelled | PASS |
| 8 | Click on delete again and confirm the deletion | The notebook is removed from the UI. The page does not require a manual refresh. Pre-existing sites are still present | PASS |
| 9 | Refresh the page | The listed notebooks are unchanged | PASS |
---

#### TC2.3.11 Add assets control to UI site form

| **JIRA ID(s):** | [NERCDL-983](https://jira.ceh.ac.uk/browse/NERCDL-983?jql=key%20in%20(NERCDL-983)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Create an R-Studio notebook that uses a landcover map asset | Notebook is created | PASS |
| 2 | Open the notebook when it has a ready status | The notebook is opened successfully | PASS |
| 3 | Select File > New Project... > New Directory > Shiny Web Application and set the Directory name to e.g. 'display' and select Create Project  | Project name is set | PASS |
| 4 | After the browser page reloads, click app.R (in Files, bottom right) | File is opened | PASS |
| 5 | In the warning message 'Package shiny required but is not installed', select Install | the Jobs tab (bottom left) to show 'âœ” Package 'shiny' successfully installed' | PASS |
| 6 | Replace the contents of app.R with the snippet below these test cases | Contents are replaced | PASS |
| 7 | Click 'Run App' (to the top-right of the app.R window), saving files if necessary | A pop-up should appear showing the contents of the asset, starting with the heading 'Environmental Information Data Centre' | PASS |
| 8 | Close the pop-up | Pop-up is closed | PASS |
| 9 | In the Console tab (bottom-left), make a note of the path to the Shiny site, e.g.
/data/notebooks/rstudio-urltest/display/ | Path is noted | PASS |
| 10 | Create an RShiny site that uses the same asset and data store as the notebook. set the source path to the path you made a note of, above. /data/ is already provided, so start with 'notebooks/' | Site is created | PASS |
| 11 | Open the site when is has a ready status | A new tab should appear, showing the asset web page, starting with the heading 'Environmental Information Data Centre' | PASS |
| 12 | Edit the RShiny site and remove the asset | Asset is removed | PASS |
| 13 | Open the site | This time you get a web page which says 'An error has occurred The application failed to start.' | PASS |
| 14 | Edit the RShiny site and re-add the 'Landcover map' asset | Asset is re-added | PASS |
| 15 | Open the site | A new tab should appear, showing the asset web page, starting with the heading 'Environmental Information Data Centre' | PASS |

```python
library(shiny)
ui <- fluidPage(
  mainPanel(
    includeHTML("/assets/landcovermap-1km-gb-v1.2/readme.html")
  )
)
server <- function(input, output, session) {
}
shinyApp(ui, server)
```

---

#### TC2.3.12 A user with "Viewer" permissions on a project cannot view shared notebooks

| JIRA ID(s): | NERCDL - 579 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Create a second account on Datalabs. | The second account will be created.  | PASS
2 | Sign into Datalabs with an admin account.  | Datalabs will open. | PASS
3 | Click on "Projects" from the nav bar and open a project. | The selected project will be open.  | PASS
4 | Click on "Settings" from the left hand nav bar.  | The settings page will open displaying the Project Details and User Permissions.  | PASS
5 | Click on the "Add User" field and enter the email for the account that was created in step 1 and click "Add". | The account will be added to the project.  | PASS
6 | Check the "Viewer" check box for the admin account in the "User Permissions" section.  | The "Viewer" check box will be checked and the account will have "Viewer" permissions. | PASS
8 | Sign in to Datalabs with the account created in step 1.  | Datalabs will open. | PASS
9 | Click open on the project displayed on the screen in the "My Projects" section.  | The Project will open.  | PASS
10 | Review the project screen.  | The "Notebooks" tab in the left hand nav bar will not be visible.  | PASS
---

#### TC2.3.13 A user with "Viewer" permissions on a project cannot view shared notebooks via direct URL

|JIRA ID(s): | NERCDL - 579 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Complete steps 1 - 8 of test case ***. |  | PASS
2 | Sign into an admin account in a different browser and navigate to the "Notebooks" page for a project that both the viewer account and admin account have access to.  | The notebooks page for the project will be open displaying all existing notebooks. | PASS
3 | Copy the URL from the notebooks page.  | The URL will be copied.  | PASS
4 | Paste the URL into the browser window where the viewer account is signed in and click ENTER.  | The Notebooks page will open displaying "No Notebooks to display".  | PASS
---

#### TC2.3.14 Users can collaborate on a notebook at the same time

| JIRA ID(s): | NERCDL - 1079 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an account that has access to Notebooks.  | Datalabs will open.  | PASS
2 | Click on the "Projects" tab from the top nav bar.  | The projects page will open displaying the projects you have access to.  | PASS
3 | Click "Open" on a Project that you have access to.  | The project will open to the Information page.  | PASS
4 | Click on "Notebooks". | The Notebooks page will open displaying all exisiting notebooks in the project.  | PASS
5 | Click "Open" on a notebook that you have access to.  | The Notebook will open. | PASS
6 | Repeat steps 1 - 5 with another account that has access to the same project and open the same notebook as was opened in step 5.  |  | PASS
7 | Open the same file with both accounts and edit the file.  | Each account will be able to see the other account making live updated to the document.  | PASS
---

#### TC2.3.15 When RStudio, Zeppelin and Kupyter notebooks are set to "Private", non - admins will not be able to see/launch the notebook from Datalabs

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Click "Open" on a project you have access to.  | The Project will open displaying the "Information" page.  | PASS
3 | Click the "Notebooks" tab on the Project page. | The Notebooks page will open displaying existing notebooks.  | PASS
4 | Click the button with three vertical dots next to the notebook you wish to make private.  | A dropdown menu will open featuring options to make the notebook either "Private" or "Project".  | PASS
5 | Click "Set Access: Private". | The dropdown menu will close and the notebook will be set to "Private". | PASS
6 | Click on the Settings tab from the left hand nav bar.  | The Settings page will open displaying Project Details and User Permissions.  | PASS
7 | Add a non admin account as a viewer on the project.  | The account will be featured in the Users Permissions section and will only have the "Viewer" check box checked.  | PASS
8 | Sign into Datalabs with the non - admin account and open the Project that was selected in step 2.  | The Project will open displaying the "Information" page.  | PASS
9 | Click on the "Notebooks" tab.  | The "Private" notebooks that were set in step 5 will not be visible.  | PASS
10 | Repeat steps 6 - 9 making the non - admin account a "User" this time. | The "Private" notebooks that were set in step 5 will not be visible.  | PASS
---

#### TC2.3.16 When a non - admin user is using a "Project" status RStudio notebook, if it is set to "Private" by an admin the token they obtain when loading the notebook will allow them to refresh/use the Notebook for up to 1 hour after the notebook was opened

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
 | Click on a Project that the account has "User" access to. (If no projects are available make the non - admin account a "User" on a project with an admin account) | The Project will open displaying the "Information" page.  | PASS
 | Click on the Notebooks tab.  | The Notebooks page will open displaying existing notebooks.  | PASS
 | Click "Open" on a RStudio notebook. (If there are no RStudio notebooks then use an admin account to create one) | The RStudio notebook will open.  | PASS
 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
 | Click "Open" on the Project that was selected in step 2.  | The Project will open displaying the "Information" page.  | PASS
 | Click on the Notebooks tab.  | The Notebooks page will open displaying existing notebooks.  | PASS
 | Click the button with three vertical dots next to the notebook you wish to make private.  | A dropdown menu will open featuring options to make the notebook either "Private" or "Project".  | PASS
 | Click "Set Access: Private". | The dropdown menu will close and the notebook will be set to "Private". | PASS
 | Review what happens on the notebook that was opened by the non - admin account.  |  | PASS
 | With the non - admin account refresh the Notebooks page.  | The RStudio notebook will no be visible.  | PASS
 | With the admin account refresh the Notebooks page.  | The RStudio notebook will be visible.  | PASS
 | Click "Open" on the RStudio notebook.  | The RStudio notebook will open.  | PASS
---

#### TC2.3.17 When a Zeppelin notebook is set to "Private" whilst in use, the login password is reset causing the notebook to go unresponsive and prompt the user to re - login and only an admin user can relaunch the notebook from Datalabs

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
2 | Click on a Project that the account has "User" access to. (If no projects are available make the non - admin account a "User" on a project with an admin account) | The Project will open displaying the "Information" page.  | PASS
3 | Click on the Notebooks tab.  | The Notebooks page will open displaying existing notebooks.  | PASS
4 | Click "Open" on a Zeppelin notebook. (If there are no Zeppelin notebooks then use an admin account to create one) | The Zeppelin notebook will open.  | PASS
5 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
6 | Click "Open" on the Project that was selected in step 2.  | The Project will open displaying the "Information" page.  | PASS
7 | Click on the Notebooks tab.  | The Notebooks page will open displaying existing notebooks.  | PASS
8 | Click the button with three vertical dots next to the notebook you wish to make private.  | A dropdown menu will open featuring options to make the notebook either "Private" or "Project".  | PASS
9 | Click "Set Access: Private". | The dropdown menu will close and the notebook will be set to "Private". | PASS
10 | Review what happens on the notebook that was opened by the non - admin account.  | The notebook will become unresponsive and ask for a re-login.  | PASS
11 | With the non - admin account refresh the Notebooks page.  | The Zeppelin notebook will not be visible on the page.  | PASS
12 | With the admin account refresh the Notebooks page.  | The Zeppelin notebook will be visible.  | PASS
13 | Click "Open" on the Zeppelin notebook.  | The Zepellin notebook will open.  | PASS
---

#### TC2.3.18 When Jupyter and Jupyter Lab notebooks are set to "Private" whilst in use, the login password is reset causing the notebook to go unresponsive and asks for a re-login and only and admin user can relaunch the notebook from Datalabs

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
2 | Click on a Project that the account has "User" access to. (If no projects are available make the non - admin account a "User" on a project with an admin account) | The Project will open displaying the "Information" page.  | PASS
3 | Click on the Notebooks tab.  | The Notebooks page will open displaying existing notebooks.  | PASS
4 | Click "Open" on a Jupyter notebook. (If there are no Jupyter notebooks then use an admin account to create one) | The Jupyter notebook will open.  | PASS
5 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
6 | Click "Open" on the Project that was selected in step 2.  | The Project will open displaying the "Information" page.  | PASS
7 | Click on the Notebooks tab.  | The Notebooks page will open displaying existing notebooks.  | PASS
8 | Click the button with three vertical dots next to the notebook you wish to make private.  | A dropdown menu will open featuring options to make the notebook either "Private" or "Project".  | PASS
9 | Click "Set Access: Private". | The dropdown menu will close and the notebook will be set to "Private". | PASS
10 | Review what happens on the notebook that was opened by the non - admin account.  | The notebook will become unresponsive (may see a "dask server error" or "server connection error"). | PASS
11 | Refresh the Jupyter notebook page.  | The page will reload and ask for a token.  | PASS
12 | With the non - admin account refresh the Notebooks page.  | The Jupyter notebook will not be visible on the page.  | PASS
13 | With the admin account refresh the Notebooks page.  | The Jupyter notebook will be visible.  | PASS
14 | Click "Open" on the Jupyter notebook.  | The Jupyter notebook will open.  | PASS
---

#### TC2.3.19 When a Notebook is set to "Project" from "Private" non - admin users (with relevant project access) will be able to view/access the notebooks via Datalabs

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Make Zeppelin, Rstudio and Jupyter notebooks "Private". (Follow test cases****) | The Notebooks will become "Private".  | PASS
3 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
4 | Click on the project where the Private notebooks are located.  | The Project will open displaying the "Information" page.  | PASS
5 | Click on the Notebooks tab from the left hand nav bar.  | The Notebooks page will open displaying existing notebooks.  | PASS
6 | Use the admin account the make the notebooks "Project" (Follow the same method that was used to make them "Private" but select "Set Access: Project"). | The Notebooks will become "Project".  | PASS
7 | Using the non - admin account refresh the Notebooks page. | The Notebooks will appear on the Notebooks page. (If the non - admin is a "User" they will be able to open the notebook) | PASS
---


#### 2.2.4.1 Dask

#### 2.2.4.1.1 Create Dask Cluster

#### TC2.2.4.1.1.1 User can create a Dask cluster via the UI

| **JIRA ID(s):** | [NERCDL-964](https://jira.ceh.ac.uk/browse/NERCDL-964?jql=key%20in%20(NERCDL-964)) |OVERALL RESULT: | FAIL |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Log in to Datalabs as a project admin | User is logged in successfully and can see the admin button in the navigation bar| PASS |
| 2 | Open a project for which the user has the project admin status | Project is opened | PASS |
| 3 | Click on "Dask" in the side menu | User is taken to the Dask page. There is a button to create a Dask cluster  | PASS |
| 4 | Click on the button to create a Dask cluster | A pop-up/modal dialog is shown with numerous fields required for creating a Dask cluster. The fields are: name, internal name, data store, max workers, max worker memory, max worker CPU use. | PASS |
| 5 | Click on create without filling in the fields | The empty fields are outlined in red and there is a message stating that they cannot be blank | PASS |
| 6 | Fill in each field | When a data store is chosen an optional field is shown "Path to Conda environment" | PASS |
| 7 | Click on create | There is a confirmation message informing the user that the cluster was made. The cluster is shown in the UI |  |
| 8 | Log in to datalabs as a user who does not have admin access to the site or the project | user is logged in | PASS |
| 9 | Open the project that the cluster was created in | Project is opened successfully | PASS |
| 10 | Click on "Dask" in the side menu | User is taken to the Dask page. There is not a button to create a Dask cluster | FAIL |
---

#### TC2.2.4.1.1.2 Dask clusters are listed in the UI

| **JIRA ID(s):** | [NERCDL-962](https://jira.ceh.ac.uk/browse/NERCDL-962?jql=key%20in%20(NERCDL-962)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Log in to Datalabs as a project admin | User is logged in successfully | PASS |
| 2 | For the project that the user has admin rights, open the dask page | Dask page loads. There is a button to create a Dask cluster. Any previous Dask clusters are listed here | PASS |
| 3 | Click on the create button | A pop-up/modal dialog is shown with numerous fields required for creating a Dask cluster. The fields are: name, internal name, data store, max workers, max worker memory, max worker CPU use. | PASS |
| 4 | Fill in each field and create the cluster | The cluster is created and it is listed in the UI along with any pre-existing clusters | PASS |
| 5 | Create enough clusters so that there are 10 total clusters listed in the UI | The 10 clusters are listed in the UI. There are no pagination controls present | PASS |
| 6 | Create another 3 clusters | Clusters are created successfully. There are now pagination controls | PASS |
| 7 | Navigate to the next page (page 2) | The listed clusters continue onto the second page | PASS |
---

#### TC2.2.4.1.3 Create Condo Dask cluster

| **JIRA ID(s):** | [NERCDL-964](https://jira.ceh.ac.uk/browse/NERCDL-964?jql=key%20in%20(NERCDL-964)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Open a project JupyterLab notebook | JupyterLab opens | Pass |
| 2 | From the launcher open a terminal | Terminal opens | Pass |
| 3 | Create a Conda environment, with the command `env-control add myConda` | After some time, command completes | Pass |
| 4 | In DataLabs, navigate to Dask in the side menu | The Dask page appears | Pass |
| 5 | Click 'Create Cluster' | The Create Cluster dialog appears | Pass |
| 6 | Fill out the cluster info, including the volume mount that the notebook is on and setting the Conda path to `/data/conda/myConda`.  Choose minimum values for other fields, to reduce the load on the test cluster | Fields can be completed | Pass |
| 7 | Click Create | The dialog closes, and the new Dask cluster appears in the list | Pass |
| 8 | Make a note of the scheduler address for the next step.  Start a new notebook in your lab, using the myConda environment. | The notebook opens | Pass |
| 9 | In a cell, put the below and run the cell. | A message tells you there is one worker.  There are no errors or warnings. | Pass |

```python
from dask.distributed import Client
c = Client("<scheduler address>")
c
```

#### TC2.2.4.1.4 Dask clusters can be deleted via the UI

| **JIRA ID(s):** |  [NERCDL-963](https://jira.ceh.ac.uk/browse/NERCDL-963?jql=key%20in%20(NERCDL-963)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As a project admin navigate to the Dask page '/projects/project name/Dask' | Pre-existing Dask clusters are listed here | PASS |
| 2 | Click on the three dots next to a Dask cluster | There is an option to delete the cluster | PASS |
| 3 | Click on delete | A modal dialog/pop-up is shown asking the user to confirm or cancel the deletion | PASS |
| 4 | Click on cancel | The cluster is not deleted and is still listed on the Dask page | PASS |
| 5 | Click on delete again and confirm the deletion | The cluster is deleted and is no longer listed in the UI  | PASS |
---

#### TC2.2.4.1.5 Non project admins cannot delete Dask clusters

| **JIRA ID(s):** | [NERCDL-963](https://jira.ceh.ac.uk/browse/NERCDL-963?jql=key%20in%20(NERCDL-963)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the Dask page as a user who is not a project admin '/projects/project name/Dask' | Pre-existing Dask clusters are listed here | PASS |
| 2 | Attempt to delete a Dask cluster | There is no way to delete the Dask cluster. The three dots button is not present | PASS |
---

#### TC2.2.4.1.6 Have a Snippet button for connecting to Dask cluster

| **JIRA ID(s):** | [NERCDL-989](https://jira.ceh.ac.uk/browse/NERCDL-989?jql=key%20in%20(NERCDL-989)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | For an existing cluster click on the three dot icon | There are two options: delete or copy snippet | PASS |
| 2 | Click on copy snippet | There is a confirmation message shown in the UI stating the snippet has been copied to the clipboard | PASS |
| 3 | Create a new JupyterLab notebook | Notebook is created | PASS |
| 4 | Open the new JupyterLab notebook and paste the copied snippet into the cell | Notebook is opened and snippet is pasted | PASS |
| 5 | Run the snippet | User should see a warning about mismatched versions (because the Dask cluster and the Notebook aren't sharing a Conda environment), and a message giving client details (scheduler address and dashboard address) and cluster details (number of workers, number of cores, and memory) | PASS |
---

#### TC2.2.4.1.7 Make Dask dashboard visible through Jupyter ServerProxy

| **JIRA ID(s):** | [NERCDL-966](https://jira.ceh.ac.uk/browse/NERCDL-966?jql=key%20in%20(NERCDL-966)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Carry out the steps documented in TC 2.2.4.1.6 | The tests pass | PASS |
| 2 | Click on the left sided control panel click on the orange leaves button | The Dashboard URL field is shown along with grey buttons beneath | PASS |
| 3 | From the pasted snippet above, copy the text that is of the form 'proxy/dask-scheduler-...:8787' and paste it into the DASK DASHBOARD URL at the top of the left-hand Dask control | Text is copied and pasted into the field | PASS |
| 4 | Press return | The grey buttons turn orange | PASS |
| 5 | Click on the Graph button | A new notebook tab appears, called 'Dask Graph', which says the scheduler is empty. | PASS |
| 6 | Copy the text from the snippet similar to 'proxy/dask-scheduler-test:8787' | Text is copied | PASS |
| 7 | Navigate to <https://forraj-clustertest.test-datalabs.nerc.ac.uk/proxy/dask-scheduler-test:8787/graph> where 'forraj' is the project that contains the cluster and notebook | The same graph notebook from test 5 is shown | PASS |
| 8 | Create a new cell in the notebook | A new cell is created | PASS |
| 9 | Enter the text snippet below and run the cell | In the graph notebook the nodes turn blue as the calculation runs | PASS |
---

```python
import dask.array as da
a = da.random.normal(size=(10000, 10000), chunks=(500, 500))
a.mean().compute()
```
---

#### TC2.2.4.1.8 A dask cluster can be suspended

| JIRA ID(s): | NERCDL -1126 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Projects tab on Datalabs. | The Projects page will be open displaying all projects your account has access to.  | PASS
2 | Click "Open" on a project. (If no projects are availble click "Create Project" and fill out the form) | The project will open displaying the project information.  | PASS
3 | Click on "Dask" from the left hand menu.  | The Dask page will open displaying any existing Dask clusters.  | PASS
4 | Click "Create Cluster". | The Create Cluster form will open. | PASS
5 | Fill out the "Create Cluster" form.  | The fields on the form will be filled with the entered data and the dask cluster will be created.  | PASS
6 | Click the button with 3 verticle dots below the "Ready" indicator for the cluster you wish to suspend.  | A pop up drop down menu will open.  | PASS
7 | Click "Suspend". | The UI will change from "Ready" to "Suspended" and the cluster will be suspened.  | PASS
8 | Open Lens and review the Pods tab.  | The cluster will show as being suspended.  | PASS
9 | Click on the Deployment tab. | The replica for the suspended cluster will be 0. | PASS
---

#### TC2.2.4.1.8 A suspended dask cluster can be restarted

| JIRA ID(s): | NERCDL -1126 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Projects tab on Datalabs. | The Projects page will be open displaying all projects your account has access to.  | PASS
2 | Click "Open" on a project. (If no projects are availble click "Create Project" and fill out the form) | The project will open displaying the project information.  | PASS
3 | Click on "Dask" from the left hand menu.  | The Dask page will open displaying any existing Dask clusters.  | PASS
4 | Click the button with 3 verticle dots below the "Suspended" indicator for the cluster you wish to restart. (If there are no suspended clusters follow test case TC2.2.4.1.7 to suspend a cluster) | A pop up drop down menu will open.  | PASS
5 | Click "Turn On". | The UI will change from "Suspended" to "Creating" and then "Ready". | PASS
6 | Open Lens and review the Pods tab.  | The cluster will show as being suspended.  | PASS
7 | Click on the Deployment tab. | The replica for the suspended cluster will be 1. | PASS
---

##### 2.2.5.1 Spark

##### 2.3 Storage

##### 2.3.1 Edit Existing Storage

###### **T2.3.1.1 User can edit existing Storage**

| **JIRA ID(s):** | [NERCDL-613](https://jira.ceh.ac.uk/browse/NERCDL-613?jql=key%20in%20(NERCDL-613)) & [NERCDL-665](https://jira.ceh.ac.uk/browse/NERCDL-665?jql=key%20in%20(NERCDL-665))|OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Open an existing project | User is taken to the project info page |  |
| 2 | Ensure there is an existing storage that has been created | There is an existing storage present |  |
| 3 | Click on the edit button | A dialog is opened containing the display name, description and users with access. There are three buttons: Apply, Clear Changes and Cancel. All buttons except "Cancel" are disabled.  |  |
| 4 | Remove existing text from the text fields  | Text fields are outlined in red informing the user that they cannot be blank. All buttons are enabled. |  |
| 5 | Press "Apply" | Nothing happens |  |
| 6 | Press "Clear Changes" | The original text is now present in the text fields |  |
| 7 | Replace any text with a string that contains text, numbers and special characters | Text is replaced |  |
| 8 | Press "Apply" | Changes are applied and there is a confirmation message displayed in the UI |  |
| 9 | Click on the edit button | The edit dialog is re-opened |  |
| 10 | Edit existing text | Text is edited  |  |
| 11 | Press the cancel button | Dialog is closed and  edits are not saved  |  |
| 11 | Press the cancel button | Dialog is closed and  edits are not saved  |  |
---

###### TC2.3.1.2 User can create NFS storage

| **JIRA ID(s):** | [NERCDL-635](https://jira.ceh.ac.uk/browse/NERCDL-635?jql=key%20in%20) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the storage page | Any existing storages are shown. There is a button to create a new storage. |  |
| 2 | Click on "Create Data Store" | A dialog is shown with the following fields: Display name, storage type, storage size, internal name and description  |  |
| 3 | Fill in all fields as required and set the storage type to NFS | Storage type is set to NFS |  |
| 4 | Press "Create" | The storage is created and shown in the UI. There is a message stating that the storage was successfully created |  |

---

###### TC2.3.1.3 User can create Gluster storage

| **JIRA ID(s):** | [NERCDL-635](https://jira.ceh.ac.uk/browse/NERCDL-635?jql=key%20in%20) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the storage page | Any existing storages are shown. There is a button to create a new storage. |  |
| 2 | Click on "Create Data Store" | A dialog is shown with the following fields: Display name, storage type, storage size, internal name and description  |  |
| 3 | Fill in all fields as required and set the storage type to Gluster | Storage type is set to NFS |  |
| 4 | Press "Create" | The storage is created and shown in the UI. There is a message stating that the storage was successfully created |  |

---

###### TC2.3.1.4 Extend Data Store dialog to NFS and experiment

| **JIRA ID(s):** | [NERCDL-635](https://jira.ceh.ac.uk/browse/NERCDL-635?jql=key%20in%20) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | The following stores have been created and a Jupyterlab notebook has been mounted to these stores: Gluster and NFS | Stores exist and JupyterLabs notebooks have been mounted to these stores |  |
| 2 | Open the Jupyter lab that is using NFS storage | Lab is opened and user can either open a notebook, console or "other" e.g. terminal |  |
| 3 | Open the terminal and run 'env-control add my-environment' | The script completes successfully within 5 minutes |  |
| 4 | Refresh the page | Page is refreshed |  |
| 5 | Choose 'File New launcher' | There is a notebook named "my-environment" |  |
| 6 | Select the "my-environment" notebook | User is taken to the notebook environment |  |
| 7 | Enter print("hello") and press the play button | "hello2 appears underneath |  |
| 8 | In Datalabs view the NFS storage and press "Open" | The environment created in the above tests are shown in the Conda environment |  |
| 9 | View the "notebooks" folder | "jupyterlab-[site name]" is shown |  |
| 10 | Click on  "jupyterlab-[site name]" | There is a file named "Untitled.ipynb" present |  |
| 11 | Repeat the above tests for a Gluster storage  | The same results for NFS storage are seen |  |
---

###### TC2.3.1.5 User can add more users to a storage

| **JIRA ID(s):** | [NERCDL-651](https://jira.ceh.ac.uk/browse/NERCDL-651?jql=key%20in%20(NERCDL-651)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | View the notebooks section of Datalabs | Existing notebooks are present |  |
| 2 | Click on edit for one of the notebooks | A dialog is opened containing the display name, description and users with access. There are three buttons: Apply, Clear Changes and Cancel. All buttons except "Cancel" are disabled. |  |
| 3 | Click on the "User's with access" field | A list of all user with access to Datalabs is shown |  |
| 4 | Select a user from this list | User's email is now present in the field |  |
| 5 | Press the X next to the  user's email | The user's email is removed |  |
| 6 | Re-add the users email and press save | The user's email is saved |  |

---

###### TC2.3.1.6 User can give another user access to storage

| **JIRA ID(s):** | [NERCDL-665](https://jira.ceh.ac.uk/browse/NERCDL-665?jql=key%20in%20(NERCDL-665)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that there is at least one other user who has access to the project | There is another user who can view the project |  |
| 2 | As the project admin, navigate to the project storage page | Projects are listed |  |
| 3 | Click on the three dotted button and select edit | A dialog is shown with the current storage information |  |
| 4 | Add a second user to the storage and press save | Second user is added |  |
| 5 | Log in to datalabs as the second user and navigate to the storage page| The project that user was added to is seen here |  |
| 6 | Log back in as the administrator and remove the second user from the storage | Second user is removed |  |
| 7 | Log back in as the second user and navigate to the storage page | The storage is no longer listed and the user can no longer access the storage. |  |

---

###### TC2.3.1.7 Storages are not shared between projects

| **JIRA ID(s):** | [NERCDL-788](https://jira.ceh.ac.uk/browse/NERCDL-788?jql=key%20in%20(NERCDL-788)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the user has access to two projects each with storages | User has access to two projects each with storages |  |
| 2 | Access the first project and view the notebooks section. Press the create a notebook button | Create a notebook dialog opens |  |
| 3 | View the data store dropdown in the create a notebook dialog | Data stores for only the first project are shown |  |
| 4 | Navigate to the notebooks section of the second project | Any pre-existing notebooks are present |  |
| 5 | Click on the create notebooks button | The create notebooks dialog form is opened |  |
| 6 | View the storage dropdown | Only data stores for the second project are shown here |  |
---

###### TC2.3.1.8 Available Storage types are controlled by values in config map

| **JIRA ID(s):** | [NERCDL-841](https://jira.ceh.ac.uk/browse/NERCDL-841) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the Storage page of a project in which the logged in account has permission to create storage. | See list of any currently available data stores in the project with a Create Data Store button below it. |  |
| 2 | Click the Create Data Store button. | Shown the create data store dialog with field for Storage Type |  |
| 3 | Note the types that are available. | N/A |  |
| 4 | Take a copy of the original storage config map then update it to change the available types and restart the web-app pod (this may require a developer). Reload the page and click the Create Data Store button. | Shown the create data store dialog where the values match those just set in the image config map. |  |
| 5 | Reset the value of the config map to the original value and then restart the web-app pod (this may require a developer). | System is back to the same state as before the test was run. |  |
---

#### TC2.3.1.9 Storage can be deleted without a page refresh

| **JIRA ID(s):** | [NERCDL-1017](https://jira.ceh.ac.uk/browse/NERCDL-1017?jql=key%20in%20(NERCDL-1017)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the storage page of a project | Storage page loads and pre-existing stores are present | PASS |
| 2 | Click on the create storage button | A dialog is shown with the following fields: Display name, storage type, storage size, internal name and description | PASS |
| 3 | Fill in the required fields and create the storage | Storage is created and it is displayed in the UI  | PASS |
| 4 | Click on the three dots next to the created site | There is an option to delete the site | PASS |
| 5 | Click on delete | A confirmation dialog is shown asking the user to cancel or enter the storage name before deleting. The delete button is greyed out | PASS |
| 6 | Click on cancel | The deletion is cancelled | PASS |
| 7 | Click on delete again and confirm the deletion by entering the storage name | The delete button can be used. The storage is removed from the UI. The page does not require a manual refresh. Pre-existing sites are still present | PASS |
| 8 | Refresh the page | The listed sites are unchanged | PASS |
---

##### 2.4 Sites

###### **T2.4.1.1 User can edit existing Sites**

| **JIRA ID(s):** | [NERCDL-613](https://jira.ceh.ac.uk/browse/NERCDL-613?jql=key%20in%20(NERCDL-613)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Open an existing project | User is taken to the project info page |  |
| 2 | Ensure there is an existing site that has been created | There is an existing site present |  |
| 3 | Click on the edit button | A dialog is opened containing the display name and description. There are three buttons: Apply, Clear Changes and Cancel. All buttons except "Cancel" are disabled.  |  |
| 4 | Remove existing text from the text fields  | Text fields are outlined in red informing the user that they cannot be blank. All buttons are enabled. |  |
| 5 | Press "Apply" | Nothing happens |  |
| 6 | Press "Clear Changes" | The original text is now present in the text fields |  |
| 7 | Replace any text with a string that contains text, numbers and special characters | Text is replaced |  |
| 8 | Press "Apply" | Changes are applied and there is a confirmation message displayed in the UI |  |
| 9 | Click on the edit button | The edit dialog is re-opened |  |
| 10 | Edit existing text | Text is edited  |  |
| 11 | Press the cancel button | Dialog is closed and  edits are not saved  |  |
---

###### TC2.4.1.2 User can create new sites

| **JIRA ID(s):** | [NERCDL-677](https://jira.ceh.ac.uk/browse/NERCDL-677?jql=key%20in%20(NERCDL-677)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the sites page | Pre-existing sites are listed here |  |
| 2 | Click on the create button | A dialog is shown with the following fields: Display Name, Site Type, URL, Data Store, Source Path, Description and Visibility Status |  |
| 3 | Press the create button without entering information | Every field is outlined in red |  |
| 4 | Enter information into all fields except the visibility status. Press the create button | Site is not created.Visibility status is outlined in red with an error message informing the user that it is required |  |
| 5 | Set a visibility status and press create | The site is successfully created |  |
---

###### TC2.4.1.3 Extra fields when creating R Shiny site

| **JIRA ID(s):** | [NERCDL-683](https://jira.ceh.ac.uk/browse/NERCDL-683?jql=key%20in%20(NERCDL-683)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the sites page | Pre-existing sites are listed here |  |
| 2 | Click on the create button | A dialog is shown with the following fields: Display Name, Site Type, URL, Data Store, Source Path, Description and Visibility Status |  |
| 3 | Fill out the required fields. Set the type to R studio | And extra field appears when R Shiny is selected. This is a version field. 4.0.1 is the default value |  |
| 4 | Click on the version field | A dropdown with two options is displayed: 4.0.1 & 3.5.3 |  |
| 5 | Set the version to default and press create | Site is successfully created |  |
| 6 | Create another R Shiny site but set the version to 3.5.3 | Site is successfully created |  |
---

#### TC2.4.1.4 Sites can be deleted without a page refresh

| **JIRA ID(s):** | [NERCDL-1017](https://jira.ceh.ac.uk/browse/NERCDL-1017?jql=key%20in%20(NERCDL-1017)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the sites page of a project | Sites page loads and pre-existing sites are present | PASS |
| 2 | Click on the create site button | A dialog is shown with the following fields: Display Name, Site Type, URL, Data Store, Source Path, Description and Visibility Status | PASS |
| 3 | Fill in the required fields and create the site | Site is created and it is displayed in the UI with a requested status | PASS |
| 4 | Wait for a few minutes | The requested status changes to a ready status | PASS |
| 5 | Click on the three dots next to the created site | There is an option to delete the site | PASS |
| 6 | Click on delete | A confirmation dialog is shown asking the user to cancel or confirm | PASS |
| 7 | Click on cancel | The deletion is cancelled | PASS |
| 8 | Click on delete again and confirm the deletion | The site is removed from the UI. The page does not require a manual refresh. Pre-existing sites are still present | PASS |
| 9 | Refresh the page | The listed sites are unchanged | PASS |
---

#### TC2.4.1.5 A user can create a Panel site

| JIRA ID(s): | NERCDL -1061 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Projects tab of DataLabs.  | The Projects page will open displaying the projects that you have access to.  | PASS
2 | Click "Open" on the project you wish to create the Panel site within. | The selected project will open to the information page. | PASS
3 | Click on the Notebooks tab from the left nav bar.  | The Notebooks page will open displaying all existing notebooks in the project. | PASS
4 | Open a notebook that you have access to (preffereably Jupyter Lab). | The Jupyter Lab notebook will open in a new browser tab.  | PASS
5 | Click the blue "+" button in the top left of the screen to create a new file and name it "panel". | A new file will open. It will be visible in the left hand panel and the main panel will feature the new file as a new tab.  | PASS
6 | Double click on Python 3 under Notebook to open an ipykernel. | The ipykernel will open.  | PASS
7 | Enter the code for the panel visualtisation. Example code can be found in the "Help" section of DataLabs. | The code will be displayed in the window.  | PASS
8 | Save and close the notebook. | The notebook will be saved and closed.  | PASS
9 | On the Project page click the Sites tab from the left nav bar. | The sites page will open displaying any existing sites.  | PASS
10 | Click "Create Site". | The "Create A Site" form will open.   | PASS
11 | Fill out the "Create A Site" form and click "Create". (Select "Panel" for the type, the source path must be the path of the jupyter notebook and the data store must be the same data store that the notebook uses) | The entered data will be displayed on the form and the form will close when "Create" is clicked. The newly created Panel will be displayed on the page and the state will be "Requesting" first then "Done".  | PASS
12 | Click "Open" on the Panel site that was created in the previous step. | The Panel site will open displaying the visualisation that was coded in the notebook.  | PASS
---

#### TC2.4.1.6 A user can create a Voila site

| JIRA ID(s): | NERCDL -1061 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Projects tab of DataLabs.  | The Projects page will open displaying the projects that you have access to.  | PASS
2 | Click "Open" on the project you wish to create the Panel site within. | The selected project will open to the information page. | PASS
3 | Click on the Notebooks tab from the left nav bar.  | The Notebooks page will open displaying all existing notebooks in the project. | PASS
4 | Open a notebook that you have access to (preffereably Jupyter Lab). | The Jupyter Lab notebook will open in a new browser tab.  | PASS
5 | Click the blue "+" button in the top left of the screen to create a new file and name it "voila". | A new file will open. It will be visible in the left hand panel and the main panel will feature the new file as a new tab.  | PASS
6 | Double click on Python 3 under Notebook to open an ipykernel. | The ipykernel will open.  | PASS
7 | Enter the code for the voila visualtisation. Example code can be found in the "Help" section of DataLabs. | The code will be displayed in the window.  | PASS
8 | Save and close the notebook. | The notebook will be saved and closed.  | PASS
9 | On the Project page click the Sites tab from the left nav bar. | The sites page will open displaying any existing sites.  | PASS
10 | Click "Create Site". | The "Create A Site" form will open.   | PASS
11 | Fill out the "Create A Site" form and click "Create". (Select "Voila" for the type, the source path must be the path of the jupyter notebook and the data store must be the same data store that the notebook uses) | The entered data will be displayed on the form and the form will close when "Create" is clicked. The newly created Panel will be displayed on the page and the state will be "Requesting" first then "Done".  | PASS
12 | Click "Open" on the Voila site that was created in the previous step. | The Voila site will open displaying the visualisation that was coded in the notebook.  | PASS
---

#### TC2.4.1.7 When a user edits Panel/Voila code in their notebook the Panel/Voila site will update to display the changes made

| Jira ID(s): | NERCDL -1061 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Follow test cases TC.2.4.1.5 and TC.2.4.1.6 to create a Panel and a Voila site. |  | PASS
2 | Navigate to the Projects tab of DataLabs.  | The Projects page will open displaying the projects that you have access to.  | PASS
3 | Click "Open" on the project where the Panel and Voila sites are located. | The project will open displaying the project information. | PASS
4 | Click on the Notebooks tab from the left nav bar.  | The notebooks page will open displaying the existing notebooks.  | PASS
5 | Open the notebook where the code for the Panel and Voila sites is located. | The selected notebook will open.  | PASS
6 | Navigate to the relevant files and edit the code for the Panel and Voila sites. | The file will be edited.  | PASS
7 | Save and close the notebook.  | The changes will be saved and the notebook will be closed.  | PASS
8 | Click on the "Site" tab from the project page.  | The site page will open displaying the existing sites.  | PASS
9 | Click "Open" on the Panel/Voila sites that were previously edited.  | The edits made in step 6 will be displayed in the site.  | PASS
---

#### TC2.4.1.8 A user can suspend a Panel site

| JIRA ID(s): | NERCDL -1061 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Projects tab of DataLabs.  | The Projects page will open displaying the projects that you have access to.  | PASS
2 | Click on "Sites" from the left have nav bar.  | The site page will open displaying the existing sites.  | PASS
3 | Click on the button with 3 vertical dots for the site you wish to suspend.  | The dropdown menu will open.  | PASS
4 | Click "Suspend". | The UI will change from "Ready" to "Suspended" and the site will be suspended.  | PASS
---

#### TC2.4.1.9 A user can suspend a Voila site

| JIRA ID(s): | NERCDL -1061 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Projects tab of DataLabs.  | The Projects page will open displaying the projects that you have access to.  | PASS
2 | Click on "Sites" from the left have nav bar.  | The site page will open displaying the existing sites.  | PASS
3 | Click on the button with 3 vertical dots for the site you wish to suspend.  | The dropdown menu will open.  | PASS
4 | Click "Suspend". | The UI will change from "Ready" to "Suspended" and the site will be suspended.  | PASS
---

#### TC2.4.1.10 A non - admin cannot access a Site (Panel/Voila) that has been made "Private" but can view the Site if they enter the site URL in a browser

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Click "Open" on a Project you have access to.  | The Project will open displaying the "Information" page.  | PASS
3 | Click on the Sites tab.  | The Sites page will open displaying any existing sites.  | PASS
4 | Click the button with three vertical dots next to the Site(s) you wish to make private.  | A dropdown menu will open featuring options to make the notebook either "Private" or "Project".  | PASS
5 | Click "Set Access: Private". | The dropdown menu will close and the site will be set to "Private". | PASS
6 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
7 | Click "Open" on the project selected in step 2.  | The Project will open displaying the "Information" page.  | PASS
8 | Click on the Sites tab.  | The Sites page will open displaying any existing sites. The site that was set to "Private" will not be visible.  | PASS
9 | With the admin account click "Open" on the private site(s). | The site will open.  | PASS
10 | Copy and paste the link of the site into the browser where the non - admin account is signed in and click ENTER. | The site will open in the browser.  | PASS
---

#### TC2.4.1.11 Users must be logged in to Datalabs to view a site, even if the URL is entered directly into the browser search

| JIRA ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Click "Open" on a Project you have access to.  | The Project will open displaying the "Information" page.  | PASS
3 | Click on the Sites tab.  | The Sites page will open displaying any existing sites.  | PASS
4 | Click the button with three vertical dots next to the Site(s) you wish to make public.  | A dropdown menu will open featuring options to make the notebook either "Private", "Project" or "Public". | PASS
7 | Copy and paste the URL of the site into a broswer where Datalabs is not signed in to.  | The site will not open. The user will be redirected to the Datalabs sign in page.  | PASS
9 | Sign into Datalabs on the second browser and repeat step 5. | The site will open. | PASS
---

#### TC2.4.1.12 When a Site is set to "Project" from "Private" non - admin users will be able to view/access the site via Datalabs

| Jira ID(s): | NERCDL - 515 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Make a Voila and Panel site "Private". (Follow test cases****) | The Sites will become "Private".  | PASS
3 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
4 | Click on the project where the Private sites are located.  | The Project will open displaying the "Information" page.  | PASS
5 | Click on the Sites tab from the left hand nav bar.  | The SItes page will open displaying existing Sites.  | PASS
6 | Use the admin account the make the sites (Panel and Voila) "Project" (Follow the same method that was used to make them "Private" but select "Set Access: Project"). | The Sites will become "Project".  | PASS
7 | Using the non - admin account refresh the Sites page. | The Sites will appear on the Sites page. (If the non - admin is a "User" they will be able to open the Site) | PASS
---

##### 2.5 Settings

##### 2.5.1 Update Project Details

##### 2.5.2 Add User

###### TC2.5.2.1 New users can be added to a project

| **JIRA ID(s):** | [NERCDL-783](https://jira.ceh.ac.uk/browse/NERCDL-783?jql=key%20in%20(NERCDL-783)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As a project admin, navigate to the project settings <https://testlab.test-datalabs.nerc.ac.uk/projects/project-name-here/settings>| User can access the project settings page for a project which they are an admin. A list of users with access to the project, and their permissions, are shown on this page. |  |
| 2 | Click on the add user field | A drop-down of users are shown. The drop down is shown directly above or below the user field, depending on how far the page has been scrolled up or down |  |
| 3 | Select a user from the the list | User is selected |  |
| 4 | Select the permissions drop-down to the right of the user field | Three permission options are available: Admin, User or Viewer |  |
| 5 | Select the user option | User option is selected |  |
| 6 | Click on "Add" | User is added to the user permissions list below the add user field |  |
| 7 | Sign into Datalabs as this user | User has access to the project |  |
---

##### 2.6 Log in workflow

##### 2.6.1 Sign up

###### TC2.6.1.1 User can sign up

| **JIRA ID(s):** | [NERCDL-581](https://jira.ceh.ac.uk/browse/NERCDL-581?jql=key%20in%20(NERCDL-581)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the oidc configmap is set to standard. A developer will need to check this | The oidc configmap is set to standard |  |
| 2 | Navigate to the datalabs homepage | User is presented with the login/sign up buttons |  |
| 3 | Click on Sign Up | User is shown the login dialog. There is a sign up tab |  |
| 4 | Select the sign up tab |There are two fields present for the user's email and password |  |
| 5 | Enter a valid email and password | Email is displayed and the password is hidden |  |
| 6 | Press sign up | The user is taken to a verification page where there are two buttons:Home and Verified. An email is sent to the user. |  |
| 7 | Press the verified button | USer is taken to the log in screen |  |
| 8 | Attempt to login without verifying the account  | User is taken back to the verification page  |  |
| 9 | Verify the account via the email | User is taken to a new successful verification page  |  |
| 10 | On the first verification page click on the verified button | User is taken to the login page |  |
| 11 | Using the credentials used to sign up, sign into Datalabs | User can successfully sign in |  |
---

###### TC2.6.1.2 Configurable sign up

| **JIRA ID(s):** | [NERCDL-867](https://jira.ceh.ac.uk/browse/NERCDL-867?jql=key%20in%20(NERCDL-867)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the oidc configmap is set to its alternate values (see the linked Jira issue above) | The oidc configmap is set to its alternate values |  |
| 2 | Ensure that the user is logged out of Datalabs | User is logged out |  |
| 3 | Navigate to <https://testlab.test-datalabs.nerc.ac.uk/projects>| User is re-directed to the sign in page. There is a sign up button |  |
| 4 | Click on the sign up button | User is re-directed to <https://testlab.test-datalabs.nerc.ac.uk/sign-up> and an email is created. This email is addressed to appsupport@ceh.ac.uk |  |
| 5 | Click on the home button | User is re-directed to the Datalabs homepage |  |
| 6 | Log in to Datalabs | User is logged in and re-directed to <https://testlab.test-datalabs.nerc.ac.uk/projects> |  |
---

##### 2.6.2 Sign in

###### TC2.6.2.1 User can sign in

| **JIRA ID(s):** | [NERCDL-362](https://jira.ceh.ac.uk/browse/NERCDL-362?jql=key%20in%20(NERCDL-362)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to datalabs | User is shown the homepage that contains two buttons: Sign up and log in |  |
| 2 | Click on Log in  | The log in dialog is shown and there are two fields for the user's email and password |  |
| 3 | Enter an invalid email and password combination | "Wrong email or password" message is shown. User is not signed in |  |
| 4 | Enter an email that does have access along with an incorrect password | "Wrong email or password" message is shown. User is not signed in |  |
| 5 | Enter an email that does have access along with the correct password | User is logged in and shown the projects page |  |
| 6 | View the web browser cookies for Data labs | There is an authorization cookie for test-datalabs.nerc.ac.uk |  |
---

###### TC2.6.2.2 User cannot access datalabs without signing in

| **JIRA ID(s):** | [NERCDL-362](https://jira.ceh.ac.uk/browse/NERCDL-362?jql=key%20in%20(NERCDL-362)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the user is logged out of Datalabs | User is logged out |  |
| 2 | Enter the following URL into the browser <https://testlab.test-datalabs.nerc.ac.uk/projects>| User cannot access the page and is prompted to log in |  |
| 3 | Enter the following URL <https://testlab.test-datalabs.nerc.ac.uk/projects/forraj/info>| User cannot access the page and is prompted to log in |  |
| 4 | Enter the following URL <https://testlab.test-datalabs.nerc.ac.uk/projects/forraj/notebooks>| User cannot access the page and is prompted to log in |  |
| 5 | Enter the following URL <https://testlab.test-datalabs.nerc.ac.uk/projects/forraj/storage>| User cannot access the page and is prompted to log in  |  |
---

###### TC2.6.2.3 User is re-directed to the correct site after navigating to the wrong URL

| **JIRA ID(s):** | [NERCDL-433](https://jira.ceh.ac.uk/browse/NERCDL-433?jql=key%20in%20(NERCDL-433)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to an incorrect Datalabs URL e.g. <https://badurl.test-datalabs.nerc.ac.uk/>| User is taken to a Datalabs page that informs the user that the requested page could not be found. There is a return to homepage link |  |
| 2 | Click on the return to homepage link | If the user is not already signed in, they are taken to the homepage page <https://testlab.test-datalabs.nerc.ac.uk/>. If the user is already signed in, they are re-directed to the projects overview page |  |
---

#### TC2.6.2.4 User can sign in  to datalabs deployed to Cluster-as-a-Service

| **JIRA ID(s):** | [NERCDL-433](https://jira.ceh.ac.uk/browse/NERCDL-433?jql=key%20in%20(NERCDL-433)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As a user who has an account for a Datalabs instance that is deployed to kubernetes, navigate to <https://testlab.192-171-139-83.sslip.io/> | User is shown the homepage with two buttons: sign up and log in | PASS |
| 2 | Click on log in | User is taken to a key cloak log in page with two fields for a username and password | PASS |
| 3 | Enter an invalid email and password combination and click on log in | An error message is shown stating that the email or password is invalid | PASS |
| 4 | Attempt to log in without providing any credentials | An error message is shown stating that the email or password is invalid | PASS |
| 5 | Provide the correct credentials and log in | User is logged in successfully and re-directed to the projects page | PASS |
| 6 | Click on the help menu item | User is taken to <https://testlab-docs.192-171-139-83.sslip.io/> | PASS |
| 7 | Click on the slack menu item | User is taken to <https://nerc-datalabs.slack.com/> | PASS |
---

##### 2.7 Admin

###### TC2.7.1 Admin workflow

| **JIRA ID(s):** | [NERCDL-650](https://jira.ceh.ac.uk/browse/NERCDL-650?jql=key%20in%20(NERCDL-650)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As an admin user, log into Datalabs | There is an Admin button in the navigation bar |  |
| 2 | Click on the Admin button | User is directed to the admin page. A list of project's and their resources are shown here. If there are more than 5 projects then there are pagination controls |  |
| 3 | Click on the search field | A drop-down of all projects is shown. User can also search in the field |  |
| 4 | Search for a project that exists | Project is shown in the drop-down |  |
| 5 | Click on the search result | The page is filtered to only show this project. Notebooks, storages and sites associated with the project are listed. If there are more than 10 notebooks, storages or sites, pagination controls are present |  |
| 6 | Use the pagination control to navigate back and forth between the pages of a notebook, storage or site | Pagination controls work  |  |
| 7 | In the search bar remove the filter project by clicking on the X | All projects are shown again |  |
| 8 | Search for a project that does not exit | "No Options" are shown in the dropdown |  |
| 9 | Untick all of the checkboxes below the search bar | Empty projects are now shown |  |
| 10 | Tick the storage checkbox | Only storages are shown beneath each project |  |
| 11 | Tick the site checkbox | Only storages and sites are shown beneath each project |  |
| 12 | Tick the notebooks checkbox | All three storages, sites and notebooks are shown |  |
---

###### TC2.7.2 Non-Admin users cannot access admin pages

| **JIRA ID(s):** | [NERCDL-650](https://jira.ceh.ac.uk/browse/NERCDL-650?jql=key%20in%20(NERCDL-650)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Log into Datalabs as a non-admin user | Admin button is not present in top navigation bar |  |
| 2 | Attempt to access <https://testlab.test-datalabs.nerc.ac.uk/admin/resources>| User cannot access any admin resources |  |
| 3 | Attempt to access <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| User cannot access any user permissions|  |
---

###### TC2.7.3 User permissions api returns the correct permissions

| **JIRA ID(s):** | [NERCDL-786](https://jira.ceh.ac.uk/browse/NERCDL-786?jql=key%20in%20(NERCDL-786)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Log in as an admin user | User is logged in and is taken to the /projects page |  |
| 2 | View the chrome developer tools, switch to the network tab and reload the page | A list of network calls are shown |  |
| 3 | View the response for the second to last api call | Contains the projects the user has access to and the admin status:  "system:instance:admin". It also contains the catalogue status e.g. catalogue publisher |  |
| 4 | Log out of Datalabs | User is logged out successfully |  |
| 5 | Log in as a user that is not an admin | User is logged in and is taken to the /projects page |  |
| 6 | Repeat steps 1-3 as the non-admin user | Api response only contains the projects the user has access to. It does not contain admin information |  |
---

###### TC2.7.4 Admin user has access to user management page

| **JIRA ID(s):** | [NERCDL-664](https://jira.ceh.ac.uk/browse/NERCDL-664?jql=key%20in%20(NERCDL-664)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Log into Datalabs as an admin user | User successfully logs in and there is an admin button in the top navigation menu |  |
| 2 | Click on the admin button | User is taken to the resources admin page. There is a "Users" tab on the left side of the page |  |
| 3 | Click on the "Users" tab | User is taken to the user management page |  |
---

###### TC2.7.4 User management page filters functionality tests PART 1

| **JIRA ID(s):** | [NERCDL-664](https://jira.ceh.ac.uk/browse/NERCDL-664?jql=key%20in%20(NERCDL-664)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Whilst on the user management page, click on the users field. **Note:** Ensure that the logged in account is a part of multiple projects and is the project admin for at least one project | A drop down of users are displayed. The current logged in user should be displayed here |  |
| 2 | Start to type in a known username | The drop-down list is filtered |  |
| 3 | Select a user by clicking on an item from the drop-down list | User is now displayed in the user field and only items relating to the user are shown on the page |  |
| 4 | Enter a username that is not a user in the Datalabs system | "No options" message is shown in the drop-down |  |
| 5 | Click on the X next to the selected user | User is removed from the field and the page is no longer filtered against the one user |  |
| 6 | View the filter checkboxes | There are various admin, user and owner filters |  |
| 7 | Select some filters e.g. instance admin and project admin | The page is filtered to only show users that meet at least one of these filter requirements. Checkboxes are clearly marked as selected |  |
| 8 | Select only the project admin filter | The logged in user should be shown on the page along with any other users who are project admins. The number of projects is shown beneath the user's name on the page. |  |
| 9 | Click on the user's name | A drop-down/page expansion shows all of the projects which the user has project admin status |  |
---

###### TC2.7.5 User management page filters functionality tests PART 2

| **JIRA ID(s):** | [NERCDL-789](https://jira.ceh.ac.uk/browse/NERCDL-789?jql=key%20in%20(NERCDL-789)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | On the user management page, ensure that the following users have the following permissions: andrew.longmore@tessella.com - Catalogue admin, rajdeep.uppal@tessella.com - catalogue publisher, alex.lee@tessella.com - catalogue editor, dean.selby@tessella.com - catalogue user | Permissions are set |  |
| 2 | Select the catalogue admin filter | Only users that are catalogue admins are shown e.g. andrew.longmore@tessella.com |  |
| 3 | Select the catalogue publisher filter | Only users that are catalogue admins are shown e.g. rajdeep.uppal@tessella.com |  |
| 4 | Select the catalogue editor editor filter | Only users that are catalogue editors are shown e.g. alex.lee@tessella.com |  |
| 5 | Do not select any filters and expand dean.selby@tessella.com | User has catalogue publisher permissions set  |  |
---

###### TC2.7.6 Instance Admin tests

| **JIRA ID(s):** | [NERCDL-787](https://jira.ceh.ac.uk/browse/NERCDL-787?jql=key%20in%20(NERCDL-787)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As an instance admin, navigate to <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| A list of users are shown along with their permissions |  |
| 2 | Select the instance admin filter | All users that are instance admins are shown. The logged in user is also shown |  |
| 3 | Attempt to remove the logged in user's instance admin status | User is unable to remove their own instance admin status |  |
| 4 | Make a non-instance admin an instance admin | User is now an instance admin |  |
| 5 | Log in as this user and attempt to access <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| User can access this endpoint |  |
---

###### TC2.7.7 Catalogue service is controlled by config.yaml

| **JIRA ID(s):** | [NERCDL-790](https://jira.ceh.ac.uk/browse/NERCDL-790?jql=key%20in%20(NERCDL-790)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | With the config set to show catalogue permissions, navigate to <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| There are catalogue filters present on this page. These filters include admin, publisher and editor. There are also the following filters: instance admin, project user, project admin, project user, site owner, notebook owner and storage access |  |
| 2 | Turn the catalogue permissions off in the config file. A developer may have to do this. | Permissions are turned off |  |
| 3 | Navigate to <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| The catalogue filters have been removed. The other filters listed in step 1 are still present. The layout of the filters and page has not been negatively effected by the removal of catalogue filters/permissions |  |
| 4 | Select the filters currently present on the page | These filters still work and filter the users correctly |  |
---

###### TC2.7.8 Remove hard-coding of new instance admins

| **JIRA ID(s):** | [NERCDL-876](https://jira.ceh.ac.uk/browse/NERCDL-876?jql=key%20in%20(NERCDL-876)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the user has two accounts that have access to Datalabs: Account 1 (instance admin) & account 2 (not an admin) | User has two accounts that can access Datalabs |  |
| 2 | Ask a developer to make the database changes documented in <https://jira.ceh.ac.uk/browse/NERCDL-876>| Config changes are made |  |
| 3 | Log into Datalabs with account 2 | User is logged in successfully. This account has the admin tab available. |  |
| 4 | Navigate to <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| The user is listed as an instance admin |  |
| 5 | Log out and log back in with account 1 | This account is no longer an instance admin (as it was before the database change) |  |
| 6 | Attempt to access <https://testlab.test-datalabs.nerc.ac.uk/admin/users>| User cannot access this page |  |
| 7 | Log out and ask a developer to revert the changes | Changes are reverted |  |
| 8 | Log into Datalabs with account 1 | The user is back to being an instance admin |  |
| 9 | Log into Datalabs with account 2 | The user is back to being a non-instance admin |  |
---

###### TC2.7.9 Data manager role exists

| **JIRA ID(s):** | [NERCDL-908](https://jira.ceh.ac.uk/browse/NERCDL-908?jql=key%20in%20(NERCDL-908)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Log in to datalabs as a user that is an instance admin (user 1). Ensure you have access to a second account that is not an instance admin (user 2) | User logs in successfully. "Admin" & "Asset repo" menu items are present in the navigation bar |  |
| 2 | Click on the admin button and select "users" | A list of all users and their roles are shown. User 2 is not an instance admin or data manager |  |
| 3 | Log in as user 2 | The admin and asset repo buttons are not present in the navigation bar |  |
| 4 | Log back in as user 1 and grant user 2 data manager access | User is granted data manager roles |  |
| 5 | Select the data manager filter | User 2 is returned in the list of users |  |
| 6 | Remove the filter and select the instance admin filter | User 1 is returned and user 2 is not |  |
| 7 | Log in as user 2 | Asset repo is now present in the navigation bar |  |
| 8 | Click on "Asset Repo" | User is taken to "/assets/add-metadata" |  |
| 9 | Log on as user 1 and click on "Asset Repo" | User is taken to "/assets/add-metadata" |  |
---

#### TC2.7.10 Dask clusters have been added to the admin page

| **JIRA ID(s):** | [NERCDL-1029](https://jira.ceh.ac.uk/browse/NERCDL-1029?jql=key%20in%20(NERCDL-1029)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As an admin user, navigate to the admin page '/admin/resources' | User has access to this page. There is a filter for clusters | PASS |
| 2 | Select a project that the user has access to via the drop down | All notebooks, clusters, stores and sites that belong to the project are shown here | PASS |
| 3 | Deselect all filters except the cluster filter | Only the clusters for the selected project are shown | PASS |
| 4 | Deselect all filters | Nothing is shown on the page | PASS |
---

#### TC2.7.11 The admin resources page doesn't show storage/notebooks/sites not shared with the instance admin

| **JIRA ID(s):** | [NERCDL-1042](https://jira.ceh.ac.uk/browse/NERCDL-1042?jql=key%20in%20(NERCDL-1042)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the user has access to two accounts. Account A is a project admin. Account B is an instance admin and a project admin for the same project. | User has access to both of these accounts | PASS |
| 2 | As A, create a data store. B must not be a user on the data store. | The data store is created | PASS |
| 3 | As A, create a JupyterLab notebook. The sharing status must be Private. | The notebook is created | PASS |
| 4 | As A, create an NBViewer site. The visibility status must be Private. | The site is created | PASS |
| 5 | As B, check that you *can not* see the artifacts created above in the Project (as A has not shared them). | User B cannot see any of the artifacts created by user A | PASS |
| 6 | In the admin resources page, view the project the artifacts were created in. | All of the artifacts created by user A can be seen by user B in the admin resources page | PASS |
---

#### TC2.7.12 An admin can create a message from the Admin page

| JIRA ID(s): | NERCDL - 1125 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Datalabs Admin tab.  | The Admin page will open. The Resource tab will be selected by default.  | PASS
2 | Click on "Messages" from the left hand menu. | The Messages page will open. All existing messages will be displayed in a table. Each message in the table will display the message, the expiry time and preview and delete buttons.  There will be a Create New Message form at the top of the page.  | PASS
3 | Click on the "Messages" field below "Create New Message" and type a message.  | The typed message will appear in the Message field.  | PASS
4 | Click on the date field titled "Expiry".  | The date selector tool will open.  | PASS
5 | Set an expiry date for anytime in the future and click somewhere on the screen outside of the date selection pop up. | The selected date will be displayed at the top of the pop up window and the window will close when the user clicks outside of the pop up.  | PASS
6 | Click "Create". | The message will be created. It will appear as a banner at the top of the Datalabs page.  | PASS
7 | Review the current browser page.  | The message that was previously created will be displayed in the Existing Messages table. Displaying the message and the expiry date.  | PASS
8 | Click on "Projects" in the top nav bar.  | The message at the top of the Datalabs page will still be present.  | PASS
---

#### TC2.7.13 An admin can preview a message whilst it is being created

| JIRA ID(s): | NERCDL - 1125 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Datalabs Admin tab.  | The Admin page will open. The Resource tab will be selected by default.  | PASS
2 | Click on "Messages" from the left hand menu. | The Messages page will open. All existing messages will be displayed in a table. Each message in the table will display the message, the expiry time and preview and delete buttons.  There will be a Create New Message form at the top of the page.  | PASS
3 | Click the "Preview" button in the Create New Message section. | A preview of the message will appear below the text input field.  | PASS
4 | Click on the "Messages" field below "Create New Message" and type half of a message.  | The message will appear in both the text input field and the preview message below.  | PASS
5 | Click the "Preview" button in the Create New Message section. | The preview of the message will dissappear.  | PASS
6 | Click on the "Messages" field below "Create New Message" and type the rest of the message from step 4. | The rest of the message will appear in the text input field. | PASS
7 | Click the "Preview" button in the Create New Message section. | The whole message (message from steps 4 and 6) will appear in the message preview.  | PASS
8 | Click on the date field titled "Expiry".  | The date selector tool will open.  | PASS
9 | Set an expiry date for anytime in the future and click somewhere on the screen outside of the date selection pop up. | The selected date will be displayed at the top of the pop up window and the window will close when the user clicks outside of the pop up.  | PASS
10 | Click "Create". | The message will be created. It will appear as a banner at the top of the Datalabs page.  | PASS
11 | Review the message on the screen.  | The message that was previously created will be displayed in the Existing Messages table. Displaying the message and the expiry date.  | PASS
---

#### TC2.7.14 An admin cannot set a message expiry date to be in the past

| JIRA ID(s): | NERCDL - 1125 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Datalabs Admin tab.  | The Admin page will open. The Resource tab will be selected by default.  | PASS
2 | Click on "Messages" from the left hand menu. | The Messages page will open. All existing messages will be displayed in a table. Each message in the table will display the message, the expiry time and preview and delete buttons.  There will be a Create New Message form at the top of the page.  | PASS
3 | Click on the "Messages" field below "Create New Message" and type a message.  | The typed message will appear in the Message field.  | PASS
4 | Click on the date field titled "Expiry".  | The date selector tool will open.  | PASS
5 | Review the expiry date selector pop up.  | All dates in the past will be greyed out.  | PASS
6 | Click on a date in the past. | The date will not be selected.  | PASS
---

#### TC2.7.15 An admin can view the messages page

| JIRA ID(s): | NERCDL - 1124 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Datalabs Admin tab.  | The Admin page will open. The Resource tab will be selected by default.  | PASS
2 | Click on "Messages" from the left hand menu. | The Messages page will open. All existing messages will be displayed in a table. Each message in the table will display the message, the expiry time and preview and delete buttons.  There will be a Create New Message form at the top of the page.  | PASS
---

#### TC2.7.16 An non - admin account cannot access the messages page

| JIRA ID(s): | NERCDL - 1124 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign in to Datalabs with a non-admin account. | Datalabs will open. | PASS
2 | Use an admin account to send the link to the "Messages" page and paste it into the browser where the non-admin is signed in and click enter.  | 404 error will be returned.  | PASS
---

#### TC2.7.17 An admin can delete existing messages 

| JIRA ID(s): | NERCDL - 1124 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Datalabs Admin tab.  | The Admin page will open. The Resource tab will be selected by default.  | PASS
2 | Click on "Messages" from the left hand menu. | The Messages page will open. All existing messages will be displayed in a table. Each message in the table will display the message, the expiry time and preview and delete buttons.  There will be a Create New Message form at the top of the page.  | PASS
3 | Click the "Delete" button on a message you wish to delete.  | The Delete Message confirmation pop up window will appear with "Cancel" and "Confirm Deletion" buttons. | PASS
4 | Click "Confirm". | The pop up window will close and the message will be deleted.  | PASS
5 | Review the messages page. | The message that was deleted will not be present in "Existing Messages". | PASS
---

#### TC2.7.18 The message APIs are calling the correct endpoints

| JIRA ID(s): | NERCDL - 1123 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the Datalabs Admin tab.  | The admin tab will be open displaying the "Resources". | PASS
2 | Open the browser developer tools and navigate to the "Network" tab.  | The "Network" tab will be open in the developer tools. | PASS
3 | Click on the "Messages" tab in Datalabs. | The messages tab will open. The API call will be displayed in the developer tools.  | PASS
4 | Click on the api call in the developer tool and scroll down in the Headers section to "Request Payload". | The allMessages API call will be displayed.  | PASS
6 | Click on "Response" tab in the developer tools. | The allMessages API call will be displayed.  | PASS
7 | Click on the Message field under Create New Message and type a message then click create.  | A new message will be created and displayed in the Existing Messages section. | PASS
8 | Repeat steps 4-6. | The createMessage API call will be displaed.  | PASS
9 | Click "Delete" button next to the message that was created in step 7 in the Existing Messages table. | The message will be deleted.  | PASS
10 | Repeat steps 4-6. | The deleteMessage API call will be displayed.  | PASS



#### 2.8 Asset Repo

##### 2.8.1 Metadata edit

###### TC2.8.1.1 Add metadata page is present

| **JIRA ID(s):** | [NERCDL-910](https://jira.ceh.ac.uk/browse/NERCDL-910?jql=key%20in%20(NERCDL-910)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that the logged in user has the data manager role | User is a data manager and can see "Asset Repo" in the header/navigation bar at the top of the page|  |
| 2 | Click on "Asset Repo" | User is taken to "/assets/add-metadata". There is a blank form with the following fields: name, version, file location, master URL, owners, visibility. Asset Id is listed as "Awaiting Submission" |  |
---

###### TC2.8.1.2 User can submit "add metadata" form

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to '/assets/add-metadata' | Page and form load correctly |  |
| 2 | Press the apply button without entering any text | All mandatory fields are highlighted in red and marked as mandatory |  |
| 3 | Set the name field to a string e.g. Test1! | Field is set and there are no validation issues from using a string containing special characters |  |
| 4 | Set the version field to a string e.g. Test1! | Field is set and there are no validation issues from using a string containing special characters |  |
| 5 | *Removed*
| 6 | *Removed*
| 7 | Set the file location to a path e.g. /Test1! | Field is set and there are no validation issues from using a path containing special characters |  |
| 8 | Set the master URL to any valid URL e.g. <https://google.com>| URL is set. There are no validation errors. |  |
| 9 | *Removed*
| 10 | Click on the owners field | A drop-down of all users in datalabs is shown |  |
| 11 | Begin to type an email that belongs to a user that has access to Datalabs | Drop-down is filtered to show the user that the email belongs to |  |
| 12 | Select the user | user's email populates the owners field |  |
| 13 | Click on visibility | A drop down is shown with two options: public and by project |  |
| 14 | Click on by project | An extra field is shown beneath: projects |  |
| 15 | Click on the projects field | A drop-down of all projects in Datalabs is shown |  |
| 16 | Select a project | Selected project populates the field |  |
| 17 | Click on apply | A dialog is shown asking the user to confirm or cancel |  |
| 18 | Click on cancel | Form is not submitted. Changes to the form are preserved |  |
| 19 | Click on apply | A dialog is shown asking the user to confirm or cancel |  |
| 20 | Click on confirm | A confirmation in the UI is shown informing the user that the metadata is set. Asset id now has an actual id string. All fields are now read only. There is a button labelled "Add another" at the bottom |  |
---

###### TC2.8.1.3 User cannot submit a form that has previously been submitted

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that a form has been submitted successfully | A form has been submitted successfully |  |
| 2 | Attempt to submit an exact copy of a form that has already been submitted | Form is not submitted because the name & version are repeated, the file location is repeated and master URL and version are repeated |  |
| 3 | Attempt to submit a form where the name and version are the only fields that match the submitted form | Form is not submitted due to the name and version matching a submitted form |  |
| 4 | Attempt to submit a form where the location is the only fields that match the submitted form | Form is not submitted due to the location matching a submitted form |  |
| 5 | Attempt to submit a form where the master URL and version are the only fields that match the submitted form | Form is not submitted due to the master name and version matching a submitted form |  |
---

#### TC2.8.3 User can edit asset repo metadata via the UI

| **JIRA ID(s):** | [NERCDL-916](https://jira.ceh.ac.uk/browse/NERCDL-916?jql=key%20in%20(NERCDL-916)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Create a Landcover Rstudio notebook and Rshiny app as per the test case TC2.3.11 Add assets control to UI site form | Test case passes without error and notebook/app are created | PASS |
| 2 | Find the Landcover asset in Asset repo > Find assets | Landcover asset is present on this page | PASS |
| 3 | Edit the asset so that the visibility is no longer public. Set the visibility to Visibility=By project, Projects= the project with the notebook and RShiny app in. Confirm the changes | Visibility is changed | PASS |
| 4 | Open the notebook created in step 1 and run the app.R file |  The 'Environmental Information Data Centre' page is shown | PASS |
| 5 | Close the pop-up page | Page is closed | PASS |
| 6 | Go back to the asset and remove the project from the asset's Projects | Project is removed | PASS |
| 7 | Go back to the notebook and RShiny app and run the app.R file | They should no longer show the 'Environmental Information Data Centre' page | PASS |
| 8 |  Go back to the asset and change the Visibility from 'By project' to 'Public'. Confirm the change. | Visibility is changed | PASS |
| 9 | Go back to the notebook, edit it, and re-add the Landcover map asset. Open the notebook | The 'Environmental Information Data Centre' page is shown | PASS |
| 10 | Go back to the RShiny site created in step 1, edit it, and re-add the Landcover map asset. Open the site | The 'Environmental Information Data Centre' page is shown | PASS |
---

#### 2.8.2 Find Asset

##### TC2.8.2.1 Need Data Manager role to see Find Asset page

| **JIRA ID(s):** | [NERCDL-936](https://jira.ceh.ac.uk/browse/NERCDL-936?jql=key%20in%20(NERCDL-936))  |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Sign in with account that does not have Data Manger role. | Should not be able to navigate to `/assets/find` either directly or by pressing the Asset Repo button in Top Bar then the Find Asset button in side bar. |  |
| 2 | Sign in with account that does have Data Manger role. | Should be able to navigate to `/assets/find` either directly or by pressing the Asset Repo button in Top Bar then the Find Asset button in side bar. |  |
---

##### TC2.8.2.2 Find Asset page lists all assets on system

| **JIRA ID(s):** | [NERCDL-936](https://jira.ceh.ac.uk/browse/NERCDL-936?jql=key%20in%20(NERCDL-936)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure logged in with account that has Data Manager role and navigate to Find Asset page. | Should be able to access Find Asset page. |  |
| 2 | Ensure there are assets with the following different characteristics: public with file location, by project with file location, public with no file location, by project with no file location. available assets for testing through the asset list page. These can be added through the Add Metadata page if necessary. | There is at least one asset meeting each of the aforementioned criteria i.e. need at least four assets. |  |
| 3 | With no filter applied to asset page, look to find each of the assets meeting the aforementioned criteria. | It should be possible to see each of the assets meeting the aforementioned criteria. |  |
---

##### TC2.8.2.3 User can filter assets on Find Asset page

| **JIRA ID(s):** | [NERCDL-936](https://jira.ceh.ac.uk/browse/NERCDL-936?jql=key%20in%20(NERCDL-936)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure logged in with account that has Data Manager role and navigate to Find Asset page. | Should be able to access Find Asset page. |  |
| 2 | Ensure that there are multiple assets available including assets with the same name but different versions. | There is more than one asset available including at least two assets with the same name but different versions. |  |
| 3 | Click on the assets box. | Shown a dropdown menu with all of the available assets. |  |
| 4 | Click on one of the assets in the dropdown menu. | The selected asset is shown in the assets box and is the only asset shown in the list of assets on the page. |  |
| 5 | Click on the assets box. | The assets that are selected should be indicated by a green tick next to them. Only assets that are selected should have the green tick next to them. |  |
| 6 | Click on another asset in the drop down. | The newly selected asset is visible alongside the originally selected asset in the list of assets. |  |
| 7 | Click on the cross in one of the asset chips in the assets box. | The asset for which the cross was clicked is no longer be visible in the assets box nor in the list of assets. |  |
| 8 | Clear all of the assets from the assets box. | All assets are now visible in the assets list again. |  |
---

##### TC2.8.2.4 User can show and hide information about the assets on the page

| **JIRA ID(s):** | [NERCDL-936](https://jira.ceh.ac.uk/browse/NERCDL-936?jql=key%20in%20(NERCDL-936)) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure logged in with account that has Data Manager role and navigate to Find Asset page. | Should be able to access Find Asset page. |  |
| 2 | Ensure there is at least one asset available. Create one using the Add Metadata page is required. | There is a list of assets with at least one asset in it. |  |
| 3 | Ensure that the asset accordion is expanded for one of the assets. | Should be able to see values for all of: Name, Version, Asset Id, File Location, Master URL, Owners, Visibility, Projects. |  |
| 4 | Click on the collapse button next to the asset title. | The asset title is still shown but the asset information is now hidden. |  |
| 5 | Click on the expand button next to the asset title. | The asset title is still shown and the asset information is now also shown. |  |
---

#### 2.8.3 Add Asset to a Notebook

##### TC2.8.3.1 A user can navigate to the add asset page using the relevant URL and the default page layout is correct

| JIRA ID(s): | NERCDL -1135 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the following URL: https://testlab.test-datalabs.nerc.ac.uk/add-assets-to-notebook  | The "Add Assets to Notebook" form will open.  | PASS
2 | Review the Add Asset to Notebook page.  | The form will feature to following fields: Project, Notebook and Assets and two buttons: "Apply" and "Reset". | PASS
---

##### TC2.8.3.2 A user can successfull add an asset to a notebook using the "Add Asset to Notebook" form

| JIRA ID(s): | NERCDL -1135 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Navigate to the following URL: https://testlab.test-datalabs.nerc.ac.uk/add-assets-to-notebook  | The "Add Assets to Notebook" form will open.  | PASS
2 | Click on the "Project" dropdown field. | A dropdown menu will open with al existing projects.  | PASS
3 | Select the project you wish to add the asset to. | The Project name will be filled in the Project field.  | PASS
4 | Click on the "Notebook" dropdown field.  | The existing notebooks for the selected project will be displayed in a dropdown menu. | PASS
5 | Select the notebook you wish to add the asset to.  | The selected notebook will be displayed in the Notebook field and an "Existing Assets on Notebook" field will appear.  | PASS
6 | Click on the "Assets" dropdown field.  | A dropdown menu of all existing assets will appear.  | PASS
7 | Select the asset you wish to add to the project. | The asset will be added to the notebook and will show in the Assets field.  | PASS
8 | Click on the arrow to open the "Assets" dropdown field. | A dropdown menu of all existing assets will appear.  | PASS
9 | Select another asset you wish to add to the project.  | The asset will be added to the notebook and will show in the Assets field.  | PASS
10 | Click "Apply". | An Add Asset(s) confirmation window will appear.  | PASS
11 | Click "Confirm". | The asset(s) will be added to the notebook.  | PASS
12 | Navigate to the notebooks page via Projects>Notebooks. | The notebooks page will be displayed.  | PASS
13 | Click the 3 verticle dots button next to the Notebook where the assets were added in step 10 then click "Edit". | The assets that were added to the notebook in step 10 will be visible. | PASS
14 | Click "Open" on the notebook and open a terminal window.  | A terminal window will open in the notebook. | PASS
15 | Use the terminal to search for an assets folder in the root directory.  | An assets folder will be present with the correct assets inside.  | PASS
---

##### TC2.8.3.3 A user can reset the "Add Assets to Notebook" page when the form is filled out

| JIRA ID(s): | NERCDL -1135 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Follow steps 1-9 of test case TC2.8.3.2. |  | PASS
2 | Click the "Reset" button. | The "Add Assets to Notebook" form will be reset to default (empty input fields). | PASS
---

##### TC2.8.3.4 A user can load the "Add Asset to Notebook" page with the parameters in the URL to view the add asset form with pre-filled fields

| JIRA ID(s): | NERCDL -1135 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Follow the steps in test case *** to add assets to a notebook.  |  | PASS
2 | Enter the following link into the browser search adding the project name, notebook name and asset(s) ids that were added to the notebook in step 1 (separate the asset(s) ids with a comma). https://testlab.test-datalabs.nerc.ac.uk/add-assets-to-notebook?project=&notebook=&assets= | The "Add Assets to Notebook" page will open.  | PASS
3 | Review the Add Assets to Notebook page.  | The assets that were added to the notebook in step 1 will be displayed in the "Existing Assets on Notebook" field and the form will be filled out with the same data that was entered when the asset(s) were added. | PASS
---

##### TC2.8.3.5 A user can add/edit assets using the form from a custom URL

| JIRA ID(s): | NERCDL -1135 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Follow the steps in test case TC2.8.3.2 to add assets to a notebook.  |  | PASS
2 | Enter the following link into the browser search adding the project name, notebook name and asset(s) ids (separate the asset(s) ids with a comma). https://testlab.test-datalabs.nerc.ac.uk/add-assets-to-notebook?project=&notebook=&assets= | The assets that were added to the notebook in step 1 will be displayed in the "Existing Assets on Notebook" field and the form will be filled out with the same data that was entered when the asset(s) were added. | PASS
3 | Click on the "Assets" dropdown field. | A dropdown menu of all existing assets will appear.  | PASS
4 | Select an asset. | The asset will be added to the notebook and will show in the Assets field.  | PASS
5 | Click "Apply" | An Add Asset(s) confirmation window will appear.  | PASS
6 | Click "Confirm". | The asset(s) will be added to the notebook.  | PASS
7 | Navigate to the notebooks page via Projects>Notebooks. | The notebooks page will be displayed.  | PASS
8 | Click the 3 verticle dots button next to the Notebook where the assets were added in step 5 then click "Edit". | The assets that were added to the notebook in step 5 will be visible. | PASS
9 | Click "Open" on the notebook and open a terminal window.  | A terminal window will open in the notebook. | PASS
10 | Use the terminal to search for an assets folder in the root directory.  | An assets folder will be present with the correct assets inside.  | PASS
---

##### TC2.8.3.6 A user can reset the add asset form when the "Reset" button is clicked after a custom URL is loaded

| JIRA ID(s): | NERCDL -1135 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Follow the steps in test case TC2.8.3.2 to add assets to a notebook.  |  | PASS
2 | Enter the following link into the browser search adding the project name, notebook name and asset(s) ids (separate the asset(s) ids with a comma). https://testlab.test-datalabs.nerc.ac.uk/add-assets-to-notebook?project=&notebook=&assets= | The assets that were added to the notebook in step 1 will be displayed in the "Existing Assets on Notebook" field and the form will be filled out with the same data that was entered when the asset(s) were added. | PASS
3 | Click on the "Assets" dropdown field. | A dropdown menu of all existing assets will appear.  | PASS
4 | Select an asset. | The asset will be added to the notebook and will show in the Assets field.  | PASS
5 | Click "Reset". | The asset that was added in step 4 will be removed and the form will return to the same state as it was in step 2. (the existing assets will remain) | PASS
---

##### TC2.8.3.7 A user can add a public asset to a notebook within any project they have access to 

| JIRA ID(s): | NERCDL - 1136 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs  with an admin accout.  | Datalabs will open.  | PASS
2 | Click "Asset Repo" from the top nav bar.  | The Asset Repo will open defaulting to the Find Assets page.  | PASS
3 | Click on the button with 3 vertical dots next to a Public asset. | A dropdown menu will appear featuring the option to "Add to Notebook". | PASS
4 | Click "Add to Notebook". | The "Add Assets to Notebook" form will open with the asset selected  in step 3 pre populated in the Assets field. | PASS
5 | Click the "Project" field and select the project where to notebook you wish to add an asset to is located.  | The selected project will fill the Project field and the seleted asset will remain in the Assets field.  | PASS
6 | Click on the "Notebook" field and select the notebook you wish to add an asset to. (Rstudio and Jupyter) | The selected notebook will fill the Notebook  field and the seleted asset will remain in the Assets field.  | PASS
7 | Click "Apply". | The assets will be added to the notebook. The  Notebook you added the asset to will change to the "Creating" status. If the asset is not a test asset it will then change to "Ready". If it is a test asset it will stay in "Creating".  | PASS
8 | Click on the button with 3 vertical dots next to the notebook the asset was added to in step 7. | A dropdown menu will appear featuring the option to "Edit". | PASS
9 | Click "Edit". | The selected asset from step 3 will be visible in the Assets field.  | PASS
---

##### TC2.8.3.8 When a "project visibility" asset is added to a notebook it will only show in the Assets field (of the Add Assets to Notebook form) when the correct project is selected 

| JIRA ID(s): | NERCDL - 1136 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs  with an admin accout.  | Datalabs will open.  | PASS
2 | Click "Asset Repo" from the top nav bar.  | The Asset Repo will open defaulting to the Find Assets page.  | PASS
3 | Click on the button with 3 vertical dots next to a "project" visibility asset. | A dropdown menu will appear featuring the option to "Add to Notebook". | PASS
4 | Click "Add to Notebook". | The "Add Assets to Notebook" form will open.  | PASS
5 | Click on the Project field and select the project that the asset is associated with.  | The selected project will be displayed in the dropdown field and the selected asset from step 3 will be displayed in the Assets field.  | PASS
6 | Click on the Project field and select a project that the asset is not associated with.  | The selected project will be displayed in the dropdown field but the Assets field will be blank.   | PASS
---

####  2.8.4 Asset Permissions

##### TC2.8.4.1 When a non-admin user tries to add an asset to a notebook only the projects that the account has access to will be visible in the "project" field of the "Add New Assets to Notebook" form

| JIRA ID(s): | NERCDL - 1136 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Click "Open" on a project and click on the "Settings" tab from the left hand nav bar.  | The Settings page will be open displaying Project Details and User Permissions.  | PASS
3 | Click on the "Add Users" field and enter, then select, the name of a non - admin account.  | The selected account will be displayed in the "Add User" field.  | PASS
4 | Select "Viewer" in the Permissions field and click "Add".  | The user will be added as a Viewer on the project. Their username will be displayed in the User Name section with only the "Viewer" check box checked. | PASS
5 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
6 | Click "Asset Repo" from the top nav bar.  | The Asset Repo will open defaulting to the Find Assets page.  | PASS
7 | Click on the button with 3 vertical dots next to an asset. | A dropdown menu will appear featuring the option to "Add to Notebook". | PASS
8 | Click "Add to Notebook".  | The "Add Assets to Notebook" form will open.  | PASS
9 | Click on the Project field.  | The Project dropdown menu will open. Only the projects that the user has access to will be displayed in the dropdown menu.  | PASS
---

##### TC2.8.4.2 Non-admin users can only see "Public" assets in the Asset Repo

| JIRA ID(s): | NERCDL - 914 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with a non - admin account.  | Datalabs will open.  | PASS
2 | Click on the "Asset Repo" tab in the top nav bar.  | The Asset Repo will open on the Find Assets page.  | PASS
3 | Review the Asset Repo.  | Only assets with visibility of "Public" will be displayed in the Asset Repo. | PASS
---

##### TC2.8.4.3 An admin user can view both "Public" and "Project" visibility assets and has the ability to edit any asset

| JIRA ID(s): | NERCDL - 914 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Click on the "Asset Repo" tab in the top nav bar.  | The Asset Repo will open on the Find Assets page.  | PASS
3 | Review the Asset Repo.  | Both "Public" and "Project" visibility assets will be visible. Each asset will have an "Edit" button beside it.  | PASS
---

##### TC2.8.4.4 Non-admin users cannot view assets if they are a "Viewer" but can view them (not edit) if they are a "User"

| JIRA ID(s): | NERCDL - 914 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account. | Datalabs will open.  | PASS
2 | Open an incognito window or a browser window on another machine and sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
3 | Use the admin account to create an asset, from the Asset Metadata" page, setting it's visibility to "Project" and adding it to a project that the non - admin account does not have access to. | The asset will be created and added to the selected project.  | PASS
4 | Using the non - admin account click on the "Asset Repo" tab in the top nav bar.  | The Asset Repo will open on the Find Assets page.  | PASS
5 | Look for the asset created in step 3. | The asset will not be visible.  | PASS
6 | Using the admin account click on the "Projects" tab of the project where the asset created in step 3 was added and navigate to the "Settings" page.  | The Settings page will open displaying the Project Information and User Permissions.  | PASS
7 | Add the non - admin account to the project as a "Viewer". | The non - admin account will be diaplyed in the User Names section with just the "Viewer" check box checked.  | PASS
8 | Repeat steps 4 and 5. | The asset will not be visible.  | PASS
9 | Using the admin account click on the "Projects" tab of the project where the asset created in step 3 was added and navigate to the "Settings" page.  | The Settings page will open displaying the Project Information and User Permissions.  | PASS
10 | Click on the "User" check box for the non admin account to provide it with User access.  | The non - admin account will be diaplyed in the User Names section with the "Viewer" and  "User" check boxes checked.  | PASS
11 | Repeat steps 4 and 5. | The asset will be visible with no "Edit" button available.  | PASS
---

##### TC2.8.4.5 Non-admin users can view and edit assets they are an owner of and they cannot remove themselves are an owner

| JIRA ID(s): | NERCDL - 914 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account. | Datalabs will open.  | PASS
2 | Open an incognito window or a browser window on another machine and sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
3 | Use the admin account to create an asset, from the Asset Metadata" page, setting it's visibility to "Project" and adding it to a project that the non - admin account does not have access to. | The asset will be created and added to the selected project.  | PASS
4 | Using the admin account, click on the "Asset Repo" tab from the top navbar.  | The Asset Repo will open on the Find Assets page.  | PASS
5 | Find the asset created in step 3 and click the "Edit" button.  | The "Edit Asset" pop up window will open for the selected asset displaying the Owners, Visibility and Projects.  | PASS
6 | In the "Owners" field enter the name of the non admin account. | The non admin account will be displayed in the Owners field.  | PASS
7 | Click "Apply". | The pop up window will close and the changes will be applied.  | PASS
8 | Using the non - admin account click on the "Asset Repo" tab in the top nav bar.  | The Asset Repo will open on the Find Assets page.  | PASS
9 | Look for the asset created in step 3. | The asset will be visible and there will be an "Edit" button next to the asset.  | PASS
10 | Click on the "Edit" button.  | The "Edit Asset" pop up window will open and the non admin account will be greyed out in the Owners field as it cannot be removed.  | PASS
---

##### TC2.8.4.6 An admin user can edit an asset without being an owner of the asset

| JIRA ID(s): | NERCDL - 914 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
2 | Click on the "Asset Repo" tab in the top nav bar.  | The Asset Repo will open on the Find Assets page.  | PASS
3 | Click the "Edit" button next to any asset.  | The "Edit Asset" pop up window will open and the admin will be able to edit the asset. | PASS
---

##### TC2.8.4.7 Both admin and non-admin accounts can access the "Find Assets" page via the Asset Repo

| JIRA ID(s): | NERCDL - 915 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account. | Datalabs will open.  | PASS
2 | Open an incognito window or a browser window on another machine and sign into Datalabs with an admin account.  | Datalabs will open.  | PASS
3 | Using both accounts review the Datalabs application. | There will be a tab in the top nav bar titles "Asset Repo".  | PASS
4 | Using both accounts click on "Asset Repo".  | By default the "Find Assets" page willl open when the Asset Repo is opened.  | PASS
---

##### TC2.8.4.8 Non-admin accounts cannot view the "Add Metadata" page in the Asset Repo

| JIRA ID(s): | NERCDL - 915 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with a non - admin account. | Datalabs will open.  | PASS
2 | Click on "Asset Repo". | The "Find Assets" page will be displayed. There will be no "Asset Metadata" tab in the left have nav bar.  | PASS
---

##### TC2.8.4.9 Making a public asset private will provide sufficient warning that notebooks using the asset will be rescheduled

| JIRA ID(s): | NERCDL - 1008 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account. | Datalabs will open. | PASS
2 | Navigate to the "Add Metadata" page. Asset Repo>Add Metadata | The Add Metadata form will be displayed. | PASS
3 | Use the admin account to create an asset, from the "Add Metadata" form, setting it's visibility to "Public. | The new asset will be created.  | PASS
4 | Navigate to the "Find Asset" page in the Asset Repo and locate the asset created in the previous step. | The asset will be visible on screen.  | PASS
5 | Click the button with 3 vertical dots and clik "Add to Notebook". | The Add to Notebook page will open displaying the "Add to Notebook" form.  | PASS
6 | Click on the "Project" field and select a project.  | The selected project will be displayed in the project field.  | PASS
7 | Click on the "Notebook" field and select a notebook.  | The selected notebook will be displayed in the notebook field. | PASS
8 | Click "Apply". | The asset will be added to the notebook. | PASS
9 | Click the button with 3 vertical dots next to the Notebook that the asset was added to and click "Edit". | The "Edit Notebook" window will open. The asset added in step 8 will be displayed in the Assets field. | PASS
10 | Navigate to the "Find Asset" page in the Asset Repo.  | The Find Asset page will be open.  | PASS
11 | Navigate to the asset created in step 2 and click "Edit". | The Edit Asset page will be open.  | PASS
12 | Click on the Visibilty field and select "By project". | "By project" will be displayed in the Visibility field and the Projects field will be displayed.  | PASS
13 | Click on the Project field and select a project different to the one that was selected in step 5 and click "Apply". | A warning message will appear detailing the change will affect the notebooks the asset is added to.  | PASS
---

#### 2.9 Catalogue

### 2.9 Catalogue link

#### TC2.9.1 User can interact with catalogue link

| **JIRA ID(s):** | [NERCDL-858](https://jira.ceh.ac.uk/browse/NERCDL-858?jql=key%20in%20(NERCDL-858)) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Sign into Datalabs | User is taken to the projects page. In the top bar there is a menu item name catalogue | PASS |
| 2 | Click on Catalogue | User is taken to the configured page in a new tab | PASS |
| 3 | Open a project | Catalogue is still present in the top bar and takes the user to the confirgured page | PASS |
| 4 | Open the asset repo page | Catalogue is still present in the top bar and takes the user to google | PASS |
| 5 | Open the admin page | Catalogue is still present in the top bar and takes the user to google | PASS |
---

#### TC2.9.2 A "Catalogue Editor" user can add Datalabs Document Types

| JIRA ID(s): | NERCDL -1086 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs with an admin account. | Datalabs will be open.  | 
2 | Navigate to the Admin page. | The Admin page will open. The Resource tab will be selected by default.  | PASS
3 | Click "Users" from the side bar menu.  | The Users page will open. The users search and filters will be displayed.  | PASS
4 | Enter the email of the account you are using and click ENTER. | The user account for the entered email will be displayed.  | PASS
5 | Click the expand arrow beside the email address.  | The information for the selected user account will be displayed.  | PASS
6 | Click on the dropdown menu and select "Catalogue editor". | Catalogue editor will be selected in the dropdown menu field.  | PASS
7 | Click "Catalogue" from the top nav bar.  | The Catalogue page will open in a new browser tab.  | PASS
8 | Click "Create" in the top right of the nav bar. | The create dropdown menu will open.  | PASS
9 | Click "DataLabs Document". | The document create form will open.  | PASS
10 | Fill out the title field of the form.  | The field will be filled with the entered data. | PASS
11 | Click "Next" then "Save" at the bottom of the page. | The document will be saved.  | PASS
12 | Click "Exit". | The created document will be displayed on the page.  | PASS
13 | Click "Search" in the top nav bar.  | The created document will be displayed on the page.  | PASS
14 | Click on the document created in step 10. | The created document will be displayed on the page.  | PASS
15 | Click "Edit". | The document form will open with editable fields.  | PASS
16 | Click "Delete". | The pop up window asking for confirmation to delete the document will appear.  | PASS
17 | Click "Yes, delete record". | The document will be deleted and will not be displayed in the catalogue.  | PASS
---

## 3. Production Deployment Test Script (Functional Testing)

### 3.1 GitHub actions

#### TC3.1.1 CI builds pass

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: | PASS |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to <https://github.com/NERC-CEH/datalab/actions>| The builds have passed | PASS |
| 2 | Navigate to <https://github.com/NERC-CEH/datalab>| The build badge at the bottom shows the current GitHub build status ('Push action Passing') | PASS |
---

### 3.2 Data storage

#### TC3.2.1 Data is stored and is present in the system

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | As an admin, navigate to <https://testlab.test-datalabs.nerc.ac.uk/admin/resources>| User has access to this page |  |
| 2 | View the page | There are notebooks, sites and storages present |  |
| 3 | View the number of pages | The number of pages has not changed since the start of the deployment process |  |
---

#### TC3.2.2 User appears in the admin tab

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the admin tab as a user who is a project admin | User is taken to the resources page |  |
| 2 | Click on the users tab  | The user that is logged in is shown here |  |
| 3 | View the resources tab | Any resources created as part of the deployment test script are shown here |  |
---

### 3.3 Front end tests

#### **TC3.3.1 User can sign in**

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to datalabs. Ensure that you are not already signed in | User is shown the homepage that contains two buttons: Sign up and log in |  |
| 2 | Click on Log in  | The log in dialog is shown and there are two fields for the user's email and password |  |
| 3 | Enter an email that does have access along with the correct password | User is logged in and shown the projects page |  |
---

#### TC3.3.2 Create a project

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to "/projects" | All of the projects that user previously had access to are still present here |  |
| 2 | Open a project | User is taken to the project information page |  |
| 3 | Click on the create project button | A dialog window is shown with the following fields: Name, Project key, Description and Collaboration Link |  |
| 4 | Enter a name, project key and description and press on the create button | The project is created |  |
| 5 | Open the project | The project is opened |  |
---

#### TC3.3.3 User can create a storage

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the storage page | Any existing storages are shown. There is a button to create a new storage. |  |
| 2 | Click on "Create Data Store" | A dialog is shown with the following fields: Display name, storage type, storage size, internal name and description  |  |
| 3 | Fill in all fields as required and set the storage type to either NFS or Gluster | Storage type is set |  |
| 4 | Press "Create" | The storage is created and shown in the UI. There is a message stating that the storage was successfully created |  |
---

#### TC3.3.4 User can create a site

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to the sites page | Pre-existing sites are listed here |  |
| 2 | Click on the create button | A dialog is shown with the following fields: Display Name, Site Type, URL, Data Store, Source Path, Description and Visibility Status |  |
| 3 | Enter information into all fields and set the data store to the storage created in TC3.3.3  | The site is successfully created |  |
---

#### TC3.3.5 User can create a notebook

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Ensure that a storage has been created (TC3.3.3) | Stores have been created |  |
| 2 | Navigate to the Notebooks section of a project | Existing notebooks are shown here |  |
| 3 | Click on "Create New Notebook" | A dialog is shown with the following fields: Display name, notebook type, data store to mount, description and sharing status  |  |
| 4 | Fill in the fields as required and set the data store mount to store created in TC3.3.3. | Store and notebook type is set |  |
| 5 | Click on "Create" | Notebook is created. There is a message in the UI stating that the creation was successful.  |  |
| 6 | Wait for a minute | The status is changed from "Requested" to "Ready" |  |
---

#### TC3.3.6 Delete the project

| **JIRA ID(s):** | [JIRA UNIQUE ID(s)](URL to JIRA ISSUE) |OVERALL RESULT: |  |
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
| 1 | Navigate to "/projects" | All of the projects that user previously had access to are still present here |  |
| 2 | Click on the three dots next to the project that was created in TC3.3.2 | There is an option to delete the project |  |
| 3 | Click on the delete option | A dialog is shown asking the user to input the project key before the deletion can be completed  |  |
| 4 | Input the project key | the delete button is no longer greyed out |  |
| 5 | Click on the delete button | The project is deleted from the list of projects shown on the "/projects" page |  |
---

#### TC3.3.7 A user can toggle "All Projects" on and off on the Projects page. 

| JIRA ID(s): | NERCDL - 740 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs. | Datalabs will open.  | PASS
2 | Click on the Projects tab.  | The Projects page will be open. All projects the user is a part of will be displayed in a list. There will be a toggle at the top of the list beside "All Projects".  | PASS
3 | Click the toggle beside "All Projects".  | All existing projects on Datalabs will be displayed in the list in alphabetical order.  | PASS
4 | Click the toggle beside "All Projects".  | The list of Projects will now only display projects the user is a part of again.  | PASS
---

## 4. Non-Functional Test Script

### 4.1 Usability Test Cases

### 4.2 Help and Documentation Test Cases

### 4.3 Compatibility Test Cases

### 4.4 Performance Test Cases

#### 4.4.1 Mongo Database

##### 4.4.1.1 When the Mongo database crashes there are Auth service and Infrastructure API liveness checks which will cause them both to restart repeatedley until the database is healthy again

| JIRA ID(s): | NERCDL - 1146 | Overall Result: | PASS
| ------------ | --------- | --------- | ------|
| **Number** | **Step** | **Expected Result** | **Result** |
1 | Sign into Datalabs. | Datalabs will open.  | PASS
2 | Open Lens and navigate to the mongo pod in the "Deployments" tab. | The Deployments tab will be open displaying the mongo pods.  | PASS
3 | Set the replicas to 0 to scale down the pod.  | The pods will scale down. The Auth0 and infrastructure api will fail liveness checks with a status 500 and keep trying to restart. The logs will show "can't connect to mongo". | PASS
4 | Review Datalabs. | The Auth0 sign in page will keep appearing requesting sign in.  | PASS
5 | Set the replicas to 1. | The mongo pod will restart. The liveness checks will run again and it may take up to 30 seconds for the restart to occur. | PASS
6 | Review Datalabs. | Datalabs will be functioning as normal.  | PASS
---

### 4.5 Security Test Cases

